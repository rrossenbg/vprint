/* ****************************************************************************
*
* Copyright (c) Francesco Abbruzzese. All rights reserved.
* francesco@dotnet-programming.com
* http://www.dotnet-programming.com/
* 
* This software is subject to the the license at http://mvccontrolstoolkit.codeplex.com/license  
* and included in the license.txt file of this distribution.
* 
* You must not remove this notice, or any other, from this software.
*
* ***************************************************************************/
Array.prototype.remove = function (c, b) { var a = this.slice((b || c) + 1 || this.length); this.length = c < 0 ? this.length + c : c; return this.push.apply(this, a) }; function MvcControlsToolkit_Trim(a) { return a.replace(/^\s+|\s+$/g, "") } function GlobalEvalScriptInElementId(d) { var c = ""; if (d.tagName == "SCRIPT") { c = d.text } else { var a = $(d).find("script"); for (var b = 0; b < a.length; b++) { c += a[b].text } } jQuery.globalEval(c) } function GlobalEvalScriptAndDestroy(b) { var a = CollectScriptAndDestroy(b); jQuery.globalEval(a) } function CollectScriptAndDestroy(d) { var c = ""; if (d.tagName == "SCRIPT") { c = d.text; $(d).remove() } else { var a = $(d).find("script"); for (var b = 0; b < a.length; b++) { c += a[b].text } a.remove() } return c } function GlobalEvalScriptInElementIdById(d) { var a = $("#" + d).find("script"); var c = ""; for (var b = 0; b < a.length; b++) { c += a[b].text } jQuery.globalEval(c) } function CollectAllScriptsInelement(d) { var a = $("#" + d).find("script"); var c = ""; for (var b = 0; b < a.length; b++) { c += a[b].text } return c } (function (g) { var h = /^[\],:{}\s]*$/; var m = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g; var l = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g; var d = /(?:^|:|,)(?:\s*\[)+/g; var a = /\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:[.,]\d+)?(Z|(?:[-+]\d+)?)/i; var e = /\/Date\((\d+)(?:[-+]\d+)?\)\//i; var f = /"(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:[.,](\d+))?(Z|(?:[-+]\d+)?)"/i; var k = /"\\\/Date\((\d+)(?:[-+]\d+)?\)\\\/"/i; var j = (window.JSON && window.JSON.parse) ? true : false; var b = j && window.JSON.parse('{"x":9}', function (o, n) { return "Y" }) === "Y"; var c = function (n, o) { if (typeof (o) === "string") { if (a.test(o)) { return new Date(o) } if (e.test(o)) { return new Date(parseInt(e.exec(o)[1], 10)) } } return o }; g.extend({ parseJSON: function (o) { var n = true; if (typeof o !== "string" || !o) { return null } o = g.trim(o); if (h.test(o.replace(m, "@").replace(l, "]").replace(d, ""))) { if (b || (j && n !== true)) { return window.JSON.parse(o, n === true ? c : undefined) } else { o = n === true ? o.replace(f, "new Date(parseInt('$1',10),parseInt('$2',10)-1,parseInt('$3',10),parseInt('$4',10),parseInt('$5',10),parseInt('$6',10),(function(s){return parseInt(s,10)||0;})('$7'))").replace(k, "new Date($1)") : o; return (new Function("return " + o))() } } else { g.error("Invalid JSON: " + o) } } }) })(jQuery); function MvcControlsToolkit_RefreshWidget(b) { jElement = $(b); var a = jElement.attr("data-refresh") || ""; if (a == "") { return } try { $(b)[a]("refresh") } catch (c) { } } var ValidationType_StandardClient = "StandardClient"; var ValidationType_UnobtrusiveClient = "UnobtrusiveClient"; var ValidationType_Server = "Server"; function MvcControlsToolkit_Validate(g, b) { if (b == ValidationType_StandardClient) { if (typeof document.getElementById(g)[MvcControlsToolkit_FieldContext_Tag] === "undefined") { return true } var f = null; try { f = document.getElementById(g)[MvcControlsToolkit_FieldContext_Tag].validate("blur") } catch (d) { } if (f && f.length) { return false } else { return true } } else { if (b == ValidationType_UnobtrusiveClient) { var a = "#" + g; var c = true; try { c = $(a).parents("form").validate().element(a) } catch (d) { } return c } } return true } function MvcControlsToolkit_FormIsValid(d, a) { if (a == ValidationType_StandardClient) { var b = null; $("#" + d).parents("form").each(function (e) { b = this[MvcControlsToolkit_FieldContext_formValidationTag] }); if (b == null) { return true } var c = b.validate("submit"); if (c && c.length) { return false } else { return true } } else { if (a == ValidationType_UnobtrusiveClient) { return $("#" + d).parents("form").validate().form() } else { return true } } } var MvcControlsToolkit_FieldContext_hasValidationFiredTag = "__MVC_HasValidationFired"; var MvcControlsToolkit_FieldContext_formValidationTag = "__MVC_FormValidation"; var MvcControlsToolkit_FieldContext_Tag = "__MVC_FieldContext"; var MvcControlsToolkit_SpecialFormName = "_Template_Data_"; function MvcControlsToolkit_FormContext$_isElementInHierarchy(a, b) { if (b == null) { return false } while (b) { if (a === b) { return true } b = b.parentNode } return false } function MvcControlsToolkit_FieldContext$validate(a) { if (typeof Sys === "undefined" || Sys === null || typeof Sys.Mvc === "undefined" || Sys.Mvc === null || typeof Sys.Mvc.FormContext === "undefined" || Sys.Mvc.FormContext === null) { return } for (var b = 0; b < this.elements.length; b++) { if (!MvcControlsToolkit_FormContext$_isElementInHierarchy(document.body, this.elements[b])) { this.clearErrors(); return [] } } return this.baseValidate(a) } function MvcControlsToolkit_FieldContext$enableDynamicValidation() { for (var b = 0; b < this.elements.length; b++) { var a = this.elements[b]; a[MvcControlsToolkit_FieldContext_Tag] = this } this.baseEnableDynamicValidation() } if (typeof Sys !== "undefined" && Sys !== null && typeof Sys.Mvc !== "undefined" && Sys.Mvc !== null && typeof Sys.Mvc.FormContext !== "undefined" && Sys.Mvc.FormContext !== null) { Sys.Mvc.FieldContext.prototype.baseValidate = Sys.Mvc.FieldContext.prototype.validate; Sys.Mvc.FieldContext.prototype.validate = MvcControlsToolkit_FieldContext$validate; Sys.Mvc.FieldContext.prototype.baseEnableDynamicValidation = Sys.Mvc.FieldContext.prototype.enableDynamicValidation; Sys.Mvc.FieldContext.prototype.enableDynamicValidation = MvcControlsToolkit_FieldContext$enableDynamicValidation; Sys.Mvc.FieldContext.prototype._dependsOn = new Array(); Sys.Mvc.FieldContext.prototype._dependencyOnBlur = function (a) { this.validate("blur") }; Sys.Mvc.FieldContext.prototype.takeDynamicValue = function (k) { var e = null; if (this.elements.length > 0) { e = this.elements[0] } if (e == null) { return null } var b = e.name; var f = b.lastIndexOf("."); if (f >= 0) { var h = b.substring(f + 1); var c = e.id; c = c.substring(0, c.lastIndexOf(h)); k = c + k } var d = document.getElementById(k); if (d == null) { return null } var g = false; if (this._dependsOn == null) { this._dependsOn = new Array(); this._dependsOn[k] = d; g = true } else { if (typeof this._dependsOn[k] === "undefined") { this._dependsOn[k] = d; g = true } } if (g) { var a = $(e); var j = function () { if (a.attr("data-elementispart")) { var l = $("#" + e.id + "_hidden"); a.trigger("pfocus"); a.trigger("pblur"); l.trigger("pfocus"); l.trigger("pblur") } else { this.validate("blur") } }; Sys.UI.DomEvent.addHandler(d, "blur", Function.createDelegate(this, j)); $(d).bind("vblur", j) } return d.value }; Sys.Mvc.ValidatorRegistry.validators.dynamicrange = function (c) { var a = c.ValidationParameters.min; var b = c.ValidationParameters.max; return function (f, e) { if (!f || !f.length) { return true } var d = Number.parseLocale(f); if (!isNaN(d) && (a == null || a <= d) && (b == null || d <= b)) { return true } return c.ErrorMessage } }; Sys.Mvc.ValidatorRegistry.validators.clientdynamirange = function (d) { var c = d.ValidationParameters.min; var e = d.ValidationParameters.max; var a = d.ValidationParameters.mindelay; var b = d.ValidationParameters.maxdelay; return function (l, g) { if (!l || !l.length) { return true } var f = Number.parseLocale(l); var k = null; var m = null; if (c != null) { var h = g.fieldContext.takeDynamicValue(c); if (h != null) { k = Number.parseLocale(h); if (isNaN(k)) { k = null } else { if (a != null) { k = k + a } } } } if (e != null) { var j = g.fieldContext.takeDynamicValue(e); if (j != null) { m = Number.parseLocale(j); if (isNaN(m)) { m = null } else { if (b != null) { m = m + b } } } } if (!isNaN(f) && (k == null || k <= f) && (m == null || f <= m)) { return true } return d.ErrorMessage } }; Sys.Mvc.ValidatorRegistry.validators.globalizeddate = function (a) { return function (d, c) { if (!d || !d.length) { return true } var b = Date.parseLocale(d); if (b != null && !isNaN(b)) { return true } return a.ErrorMessage } }; Sys.Mvc.ValidatorRegistry.validators.daterange = function (rule) { var sminValue = rule.ValidationParameters.min; var smaxValue = rule.ValidationParameters.max; var minValue = null; var maxValue = null; if (sminValue != null) { sminValue = "new " + sminValue.substring(1, sminValue.length - 1); minValue = eval(sminValue) } if (smaxValue != null) { smaxValue = "new " + smaxValue.substring(1, smaxValue.length - 1); maxValue = eval(smaxValue) } return function (value, context) { if (!value || !value.length) { return true } var convertedValue = Date.parseLocale(value); if (convertedValue != null && (minValue == null || minValue <= convertedValue) && (maxValue == null || convertedValue <= maxValue)) { return true } return rule.ErrorMessage } }; Sys.Mvc.ValidatorRegistry.validators.clientdynamicdaterange = function (f) { var e = f.ValidationParameters.min; var g = f.ValidationParameters.max; var a = f.ValidationParameters.mindelay; var b = f.ValidationParameters.maxdelay; var c = null; var d = null; return function (m, j) { if (!m || !m.length) { return true } var h = Date.parseLocale(m); if (e != null) { var k = j.fieldContext.takeDynamicValue(e); if (k != null) { c = Date.parseLocale(k); if (a != null) { c = new Date(c.getTime() + a) } } } if (g != null) { var l = j.fieldContext.takeDynamicValue(g); if (l != null) { d = Date.parseLocale(l); if (b != null) { d = new Date(d.getTime() + b) } } } if (h != null && (c == null || c <= h) && (d == null || h <= d)) { return true } return f.ErrorMessage } } } if (typeof $ !== "undefined" && $ !== null && typeof $.validator !== "undefined" && $.validator !== null && typeof $.validator.unobtrusive !== "undefined" && $.validator.unobtrusive !== null) { (function (a) { a.validator.takeDynamicValue = function (f, m) { if (f == null) { return null } var c = f.name; var g = c.lastIndexOf("."); if (g >= 0) { var j = c.substring(g + 1); var d = f.id; d = d.substring(0, d.lastIndexOf(j)); m = d + m } var e = document.getElementById(m); if (e == null) { return null } var h = false; var l = jQuery.data(f, "_dependsOn"); if (typeof l == "undefined" || l == null) { l = new Array(); l[m] = e; jQuery.data(f, "_dependsOn", l); h = true } else { if (typeof l[m] === "undefined") { l[m] = e; h = true } } if (h) { var b = a(f); var k = function () { if (b.attr("data-elementispart")) { var n = a("#" + f.id + "_hidden"); b.trigger("pfocus"); b.trigger("pblur"); n.trigger("pfocus"); n.trigger("pblur") } else { b.parents("form").first().validate().element(f) } }; a(e).blur(k); a(e).bind("vblur", k) } return e.value }; a.validator.unobtrusive.clearAndParse = function (b) { var c = a(b).parents("form"); if (c.length != 0) { c.removeData("validator") } else { a(b).removeData("validator") } a.validator.unobtrusive.parse(b) }; a.validator.unobtrusive.reParse = function (b) { a.validator.unobtrusive.clearAndParse(b); MvcControlsToolkit_ParseRegister.parse(b) }; a.validator.unobtrusive.parseExt = function (b) { a.validator.unobtrusive.parse(b); var e = a(b).first().closest("form"); var d = e.data("unobtrusiveValidation"); var c = e.validate(); a.each(d.options.rules, function (g, f) { if (c.settings.rules[g] == undefined) { var h = {}; a.extend(h, f); h.messages = d.options.messages[g]; a('[name= "' + g + '"]').rules("add", h) } else { a.each(f, function (l, k) { if (c.settings.rules[g][l] == undefined) { var j = {}; j[l] = k; j.messages = d.options.messages[g][l]; a('[name= "' + g + '"]').rules("add", j) } }) } }); MvcControlsToolkit_ParseRegister.parse(b) } })($); $.validator.unobtrusive.adapters.addBool("mandatory", "required"); $.validator.addMethod("dynamicrange", function (d, b, f) { var c = f[0]; if (c == "") { c = null } var e = f[1]; if (e == "") { e = null } if ((!d || !d.length) && this.optional(b)) { return true } var a = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { a = jQuery.global.parseFloat(d) } else { a = parseFloat(d) } if (!isNaN(a) && (c == null || c <= a) && (e == null || a <= e)) { return true } return false }, "value is not in the required range"); jQuery.validator.unobtrusive.adapters.add("dynamicrange", ["min", "max"], function (b) { var c = b.params.min, a = b.params.max; b.rules.dynamicrange = [c, a]; if (b.message) { b.messages.dynamicrange = b.message } }); $.validator.addMethod("clientdynamirange", function (m, h, e) { var f = e[0]; if (f == "") { f = null } var a = e[2]; if (a == "") { a = null } var g = e[1]; if (g == "") { g = null } var c = e[3]; if (c == "") { c = null } var l = null; var k = null; if (g != null) { g = parseFloat(g) } if (c != null) { c = parseFloat(c) } if ((!m || !m.length) && this.optional(h)) { return true } var b = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { b = jQuery.global.parseFloat(m) } else { b = parseFloat(m) } if (f != null) { var j = $.validator.takeDynamicValue(h, f); if (j != null) { l = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { l = jQuery.global.parseFloat(j) } else { l = parseFloat(j) } if (isNaN(l)) { l = null } else { if (g != null) { l = l + g } } } } if (a != null) { var d = $.validator.takeDynamicValue(h, a); if (d != null) { k = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { k = jQuery.global.parseFloat(d) } else { k = parseFloat(d) } if (isNaN(k)) { k = null } else { if (c != null) { k = k + c } } } } if (!isNaN(b) && (l == null || l <= b) && (k == null || b <= k)) { return true } return false }, "value is not in the required range"); jQuery.validator.unobtrusive.adapters.add("clientdynamirange", ["min", "mindelay", "max", "maxdelay"], function (a) { var b = a.params.min, c = a.params.mindelay; max = a.params.max, maxdelay = a.params.maxdelay; a.rules.clientdynamirange = [b, c, max, maxdelay]; if (a.message) { a.messages.clientdynamirange = a.message } }); $.validator.addMethod("globalizeddate", function (c, b, d) { if ((!c || !c.length) && this.optional(b)) { return true } var a = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { a = new Date(c); a = jQuery.global.parseDate(c) } else { a = new Date(c) } return !isNaN(a) && a != null }, "field must be a date/time"); $.validator.addMethod("daterange", function (d, b, f) { var c = f[0]; if (c == "") { c = null } var e = f[1]; if (e == "") { e = null } if (c != null) { c = new Date(c) } if (e != null) { e = new Date(e) } if ((!d || !d.length) && this.optional(b)) { return true } var a = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { a = new Date(d); a = jQuery.global.parseDate(d) } else { a = new Date(d) } if (!isNaN(a) && (c == null || c <= a) && (e == null || a <= e)) { return true } return false }, "date is not in the required range"); jQuery.validator.unobtrusive.adapters.add("daterange", ["min", "max"], function (b) { var c = b.params.min, a = b.params.max; b.rules.daterange = [c, a]; if (b.message) { b.messages.daterange = b.message } }); $.validator.addMethod("clientdynamicdaterange", function (m, h, e) { var f = e[0]; if (f == "") { f = null } var a = e[2]; if (a == "") { a = null } var g = e[1]; if (g == "") { g = null } var c = e[3]; if (c == "") { c = null } var l = null; var k = null; if (g != null) { g = parseInt(g) } if (c != null) { c = parseInt(c) } if ((!m || !m.length) && this.optional(h)) { return true } var b = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { b = jQuery.global.parseDate(m) } else { b = parseDate(m) } if (f != null) { var j = $.validator.takeDynamicValue(h, f); if (j != null) { l = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { l = jQuery.global.parseDate(j) } else { l = parseDate(j) } if (isNaN(l)) { l = null } else { if (g != null) { l = new Date(l.getTime() + g) } } } } if (a != null) { var d = $.validator.takeDynamicValue(h, a); if (d != null) { k = null; if (typeof jQuery.global !== "undefined" && typeof jQuery.global.parseFloat === "function") { k = jQuery.global.parseDate(d) } else { k = parseDate(d) } if (isNaN(k)) { k = null } else { if (c != null) { k = new Date(k.getTime() + c) } } } } if (!isNaN(b) && (l == null || l <= b) && (k == null || b <= k)) { return true } return false }, "date is not in the required range"); jQuery.validator.unobtrusive.adapters.add("clientdynamicdaterange", ["min", "mindelay", "max", "maxdelay"], function (a) { var b = a.params.min, c = a.params.mindelay; max = a.params.max, maxdelay = a.params.maxdelay; a.rules.clientdynamicdaterange = [b, c, max, maxdelay]; if (a.message) { a.messages.clientdynamicdaterange = a.message } }); jQuery.validator.unobtrusive.adapters.add("globalizeddate", [], function (a) { a.rules.globalizeddate = []; if (a.message) { a.messages.globalizeddate = a.message } }) } var DualSelect_Separator = ";;;"; var DualSelect_SelectAvial = "_AvialSelect"; var DualSelect_SelectSelected = "_SelSelect"; var DualSelect_HiddenSelectedItemsVal = ""; var DualSelect_Postfix = "___PackedValue"; var DualSelect_AvailableFilter = "_AvailableFilter"; var DualSelect_SelectedFilter = "_SelectedFilter"; var DualSelect_TempObjSource, DualSelect_TempObjDestination; function MvcControlsToolkit_SubstringRating(h, a) { h = h.toLowerCase(); a = a.toLowerCase(); var c = -true; var b = 0; var f = 0; for (var e = 0; e < h.length; e++) { if (a == "") { return [f, b] } var g = h.charAt(e); var d = a.indexOf(g); if (d == -1) { continue } f++; if (c) { b += d; c = false } else { b += d * 1000 } if (d + 1 < a.length) { a = a.substr(d + 1) } else { a = "" } } return [f, b] } function DualSelect_FilterInit(b, a) { $("#" + b + (a ? DualSelect_SelectedFilter : DualSelect_AvailableFilter)).keydown(function () { var c = this; var d = MvcControlsToolkit_Trim($(c).val()); setTimeout(function () { var h = document.getElementById(b + (a ? DualSelect_SelectSelected : DualSelect_SelectAvial)); var e = MvcControlsToolkit_Trim($(c).val()); if (d == e) { return } d = e; if (e == "") { return } var g = []; for (var f = 0; f < h.length; f++) { g.push({ rating: MvcControlsToolkit_SubstringRating(e, $(h[f]).text()), item: h[f] }) } g.sort(function (k, j) { if (k.rating[0] > j.rating[0]) { return -1 } if (j.rating[0] > k.rating[0]) { return 1 } if (k.rating[1] < j.rating[1]) { return -1 } if (j.rating[1] < k.rating[1]) { return 1 } return 0 }); h.options.length = 0; for (var f = 0; f < g.length; f++) { h.options.add(g[f].item) } if (a) { DualSelect_SaveSelection(b) } }) }) } function DualSelect_SetObjects(b, a) { if (a) { DualSelect_TempObjSource = document.getElementById(b + DualSelect_SelectAvial); DualSelect_TempObjDestination = document.getElementById(b + DualSelect_SelectSelected) } else { DualSelect_TempObjSource = document.getElementById(b + DualSelect_SelectSelected); DualSelect_TempObjDestination = document.getElementById(b + DualSelect_SelectAvial) } } function DualSelect_GetIndexForInsert(b, c) { if (b.autosort == "false") { return b.length + 1 } if (b.length == 0) { return 0 } for (var a = 0; a < b.length; a++) { if (b[a].text > c.text) { return a } } return b.length } function DualSelect_MoveElement(e, c) { DualSelect_SetObjects(e, c); var a = $("#" + e.substring(0, e.lastIndexOf("___"))); if (DualSelect_TempObjSource.length == 0) { return } iLast = 0; for (var d = 0; d < DualSelect_TempObjSource.length; d++) { if (DualSelect_TempObjSource[d].selected) { iLast = d; var f = DualSelect_TempObjSource[d]; var b = new MvcControlsToolkit_changeData(f, c ? "ItemCreating" : "ItemDeleting", 0); a.trigger("itemChange", b); if (b.Cancel == true) { continue } DualSelect_TempObjSource.remove(d); nPos = (DualSelect_TempObjDestination.length + 1); DualSelect_TempObjDestination.options.add(f, DualSelect_GetIndexForInsert(DualSelect_TempObjDestination, f)); b = new MvcControlsToolkit_changeData(f, c ? "ItemCreated" : "ItemDeleted", 0); a.trigger("itemChange", b); d-- } } DualSelect_SaveSelection(e); if (DualSelect_TempObjSource.length > 0 && iLast == 0) { DualSelect_TempObjSource.selectedIndex = 0 } else { if (DualSelect_TempObjSource.length - 1 >= iLast) { DualSelect_TempObjSource.selectedIndex = iLast } else { if (DualSelect_TempObjSource.length >= 1) { DualSelect_TempObjSource.selectedIndex = iLast - 1 } } } DualSelect_ClearSelection(DualSelect_TempObjSource); DualSelect_TempObjSource.focus; a.trigger("DualSelect_Changed") } function DualSelect_Move_Up(g, c) { DualSelect_SetObjects(g, c); var a = $("#" + g.substring(0, g.lastIndexOf("___"))); if (DualSelect_TempObjSource.length == 0) { return } if (DualSelect_TempObjSource[0].selected) { return } for (var d = 1; d < DualSelect_TempObjSource.length; d++) { if (DualSelect_TempObjSource[d].selected) { var f = DualSelect_TempObjSource[d]; var b = new MvcControlsToolkit_changeData(f, "ItemMoving", 1); a.trigger("itemChange", b); if (b.Cancel == true) { continue } var e = DualSelect_TempObjSource[d - 1]; DualSelect_TempObjSource.remove(d); DualSelect_TempObjSource.remove(d - 1); DualSelect_TempObjSource.options.add(f, d - 1); DualSelect_TempObjSource.options.add(e, d); b = new MvcControlsToolkit_changeData(f, "ItemMoved", 1); a.trigger("itemChange", b); d-- } } DualSelect_SaveSelection(g); a.trigger("DualSelect_Changed") } function DualSelect_Move_Down(g, c) { DualSelect_SetObjects(g, c); var a = $("#" + g.substring(0, g.lastIndexOf("___"))); if (DualSelect_TempObjSource.length == 0) { return } if (DualSelect_TempObjSource[DualSelect_TempObjSource.length - 1].selected) { return } for (var d = DualSelect_TempObjSource.length - 2; d > -1; d--) { if (DualSelect_TempObjSource[d].selected) { var f = DualSelect_TempObjSource[d]; var b = new MvcControlsToolkit_changeData(f, "ItemMoving", -1); a.trigger("itemChange", b); if (b.Cancel == true) { continue } var e = DualSelect_TempObjSource[d + 1]; DualSelect_TempObjSource.remove(d + 1); DualSelect_TempObjSource.remove(d); DualSelect_TempObjSource.options.add(e, d); DualSelect_TempObjSource.options.add(f, d + 1); b = new MvcControlsToolkit_changeData(f, "ItemMoved", -1); a.trigger("itemChange", b); d++ } } DualSelect_SaveSelection(g); a.trigger("DualSelect_Changed") } function DualSelect_MoveAll(e, d, b) { DualSelect_SetObjects(e, d); var a = $("#" + e.substring(0, e.lastIndexOf("___"))); var f = 0; while (DualSelect_TempObjSource.length > f) { oNode = DualSelect_TempObjSource[f]; if (b != true) { var c = new MvcControlsToolkit_changeData(oNode, d ? "ItemCreating" : "ItemDeleting", 0); a.trigger("itemChange", c); if (c.Cancel == true) { f++; continue } } DualSelect_TempObjSource.remove(oNode); DualSelect_TempObjDestination.options.add(oNode, DualSelect_GetIndexForInsert(DualSelect_TempObjDestination, oNode)); if (b != true) { var c = new MvcControlsToolkit_changeData(oNode, d ? "ItemCreated" : "ItemDeleted", 0); a.trigger("itemChange", c) } } DualSelect_SaveSelection(e); if (b != true) { a.trigger("DualSelect_Changed") } } function DualSelect_ClearSelection(b) { for (var a = 0; a < b.length; a++) { b[a].selected = false } } function DualSelect_SaveSelection(d) { var b = document.getElementById(d + DualSelect_SelectSelected); var c = ""; var e = ""; for (var a = 0; a < b.length; a++) { c += b[a].value + DualSelect_Separator } document.getElementById(d + DualSelect_HiddenSelectedItemsVal).value = c } function MvcControlsToolkit_DualSelect_Set(k, a, g, f) { var c = document.getElementById(k.id + DualSelect_Postfix + DualSelect_SelectAvial); var o = document.getElementById(k.id + DualSelect_Postfix + DualSelect_SelectSelected); if (c == null || o == null) { setTimeout(function () { MvcControlsToolkit_DualSelect_Set(k, a, g, f) }, 0); return } DualSelect_MoveAll(k.id + DualSelect_Postfix, false, true); if (a instanceof Array && c.options.length > 0) { var s = new Array(); for (var m = 0, h = c.length; m < h; m++) { s.push(MvcControlsToolkit_Parse(c.options[m].value, f)); c.options[m].selected = false } for (var m = 0, b = a.length; m < b; m++) { if (f == MvcControlsToolkit_DataType_Float) { var e = 0; var q = Math.abs(a[m] - s[0]); for (var h = 1, d = s.length; h < d; h++) { if (Math.abs(s[h] - a[m]) < q) { e = h; q = Math.abs(s[h] - a[m]) } } if (e >= 0) { var p = c.options[e]; c.options.remove(e); s.remove(e); o.options.add(p) } } else { for (var h = 0, d = s.length; h < d; h++) { if (s[h] === a[m]) { var p = c.options[h]; c.options.remove(h); s.remove(h); o.options.add(p); break } } } } DualSelect_SaveSelection(k.id + DualSelect_Postfix) } } function MvcControlsToolkit_DualSelect_SetString(a, b) { MvcControlsToolkit_DualSelect_Set(a, b, null, MvcControlsToolkit_DataType_String) } function MvcControlsToolkit_DualSelect_Get(c, f) { var d = document.getElementById(c.id + DualSelect_Postfix + DualSelect_SelectSelected); if (d == null) { setTimeout(function () { MvcControlsToolkit_DualSelect_Get(c, f) }, 0); return } var e = new Array(); for (var b = 0, a = d.length; b < a; b++) { e.push(MvcControlsToolkit_Parse(d.options[b].value, f)) } return e } function MvcControlsToolkit_DualSelect_GetString(a) { return MvcControlsToolkit_DualSelect_Get(a, MvcControlsToolkit_DataType_String) } var defaultYear = 1970 + 0; var defaultMonth = 0 + 0; var defaultDay = 1 + 0; var defaultHour = 0 + 0; var defaultMinute = 0 + 0; var defaultSecond = 0 + 0; function DateInput_Initialize(id) { if (document.getElementById(id + "_Year") != null) { document.getElementById(id + "_Year").onkeypress = DateInputYearKeyVerify; document.getElementById(id + "_Year").onpaste = DateInputYearHandlePaste; document.getElementById(id + "_Year").ondrop = DateInputYearHandlePaste; document.getElementById(id + "_Year").onchange = DateInputChanged } if (document.getElementById(id + "_Month") != null) { document.getElementById(id + "_Month").onchange = DateInputChanged } if (document.getElementById(id + "_Day") != null) { document.getElementById(id + "_Day").onchange = DateInputChanged } if (document.getElementById(id + "_Hours") != null) { document.getElementById(id + "_Hours").onchange = DateInputChanged } if (document.getElementById(id + "_Minutes") != null) { document.getElementById(id + "_Minutes").onchange = DateInputChanged } if (document.getElementById(id + "_Seconds") != null) { document.getElementById(id + "_Seconds").onchange = DateInputChanged } if (eval(id + "_DateInCalendar")) { var options = eval(id + "_CalendarOptions"); $("#" + id + "_Calendar").datepicker(options) } DateInputChanged(null, id, true, null, true); $("#" + id + "_Hidden").data("ready", true) } function DateInputGetNumDays(b, a) { b = b + 1; if (a % 4 == 0) { return (b == 9 || b == 4 || b == 6 || b == 11) ? 30 : (b == 2) ? 29 : 31 } else { return (b == 9 || b == 4 || b == 6 || b == 11) ? 30 : (b == 2) ? 28 : 31 } } function DateTimeAdjustYears(d, c, a) { if (d == null || d.tagName != "SELECT") { return } var b = 0; if (c == d.options[0].value && a == d.options[d.options.length - 1].value) { return } var e = d.value; d.options.length = 0; for (i = c; i <= a; i++) { if (i < 10) { d.options[b] = new Option("   " + i, i) } else { if (i < 100) { d.options[b] = new Option("  " + i, i) } else { if (i < 1000) { d.options[b] = new Option(" " + i, i) } else { d.options[b] = new Option("" + i, i) } } } b++ } MvcControlsToolKit_SetDateElement(d.id, e) } function DateTimeAdjustMonthes(d, c, a) { if (d == null) { return } var b = 0; if (c == d.options[0].value && a == d.options[d.options.length - 1].value) { return } var e = d.value; d.options.length = 0; for (i = c; i <= a; i++) { d.options[b] = new Option(DateTimeMonthes[i], i + 1); b++ } MvcControlsToolKit_SetDateElement(d.id, e) } function DateTimeAdjustDays(d, c, a) { if (d == null) { return } var b = 0; if (c == d.options[0].value && a == d.options[d.options.length - 1].value) { return } var e = d.value; d.options.length = 0; for (i = c; i <= a; i++) { if (i < 10) { d.options[b] = new Option(" " + i, i) } else { d.options[b] = new Option("" + i, i) } b++ } MvcControlsToolKit_SetDateElement(d.id, e) } function DateTimeAdjustTimeElement(d, c, a) { if (d == null) { return } var b = 0; if (c == d.options[0].value && a == d.options[d.options.length - 1].value) { return } var e = d.value; d.options.length = 0; for (i = c; i <= a; i++) { if (i < 10) { d.options[b] = new Option("0" + i, i) } else { d.options[b] = new Option("" + i, i) } b++ } MvcControlsToolKit_SetDateElement(d.id, e) } function DateInputYearHandlePaste(a) { a = (a) ? (a) : ((window.event) ? (window.event) : null); if (a == null) { return true } var b = (a.target) ? (a.target) : ((event.srcElement) ? (event.srcElement) : null); if (b == null) { return true } var c; if (a.type == "paste") { c = window.clipboardData.getData("Text") } else { if (a.type == "drop") { c = a.dataTransfer.getData("Text") } else { return true } } for (i = 0; i < c.length; i++) { keyCode = c.charCodeAt(i); if (keyCode == 13 || keyCode == 8) { continue } if ((keyCode >= 48) && (keyCode <= 57)) { continue } else { return false } } b.value = c; return false } function DateInputYearKeyVerify(a) { a = (a) ? (a) : ((window.event) ? (window.event) : null); if (a == null) { return true } var b = (a.target) ? (a.target) : ((event.srcElement) ? (event.srcElement) : null); if (b == null) { return true } var c = ((a.charCode || a.initEvent) ? a.charCode : ((a.which) ? a.which : a.keyCode)); if (c == 0 || c == 13 || c == 8) { return true } if ((c >= 48) && (c <= 57)) { return true } return false; var d = b.value } function DateTimeInput_UpdateCalendar(a) { Nanno = document.getElementById(a + "_Year").value; Nmese = document.getElementById(a + "_Month").value; Ngiorno = document.getElementById(a + "_Day").value; var b = new Date(Nanno, Nmese - 1, Ngiorno); var c = $("#" + a + "_Calendar"); var d = c.datepicker("option", "dateFormat"); if (d == null) { d = "mm/dd/yy" } c.datepicker("setDate", $.datepicker.formatDate(d, b)) } function DateTimeInput_UpdateFromCalendar(d, a) { var h = $("#" + a + "_Calendar"); if (d == null) { return } var j = h.datepicker("option", "dateFormat"); if (j == null) { j = "mm/dd/yy" } var b = null; try { b = $.datepicker.parseDate(j, d) } catch (g) { b = new Date() } var f = h.datepicker("option", "minDate"); var k = h.datepicker("option", "maxDate"); var l = null; var c = null; if (f != null) { l = $.datepicker.parseDate(j, f) } if (k != null) { c = $.datepicker.parseDate(j, k) } if (l != null && b < l) { b = l } if (c != null && b > c) { b = c } document.getElementById(a + "_Year").value = b.getFullYear(); document.getElementById(a + "_Month").value = b.getMonth() + 1; document.getElementById(a + "_Day").value = b.getDate(); DateInputChanged(null, a, true) } function DateTimeInput_UpdateCalendarMinMax(a, c, e) { var b = $("#" + a + "_Calendar"); var d = b.datepicker("option", "dateFormat"); if (d == null) { d = "mm/dd/yy" } if (c != null) { b.datepicker("option", "minDate", $.datepicker.formatDate(d, c)) } else { b.datepicker("option", "minDate", null) } if (e != null) { b.datepicker("option", "maxDate", $.datepicker.formatDate(d, e)) } else { b.datepicker("option", "maxDate", null) } } function DateInputChanged(evt, cid, update, force, init) { var clientID; if (cid == null) { evt = (evt) ? (evt) : ((window.event) ? (window.event) : null); if (evt == null) { return false } var sorg = (evt.target) ? (evt.target) : ((event.srcElement) ? (event.srcElement) : null); if (sorg == null) { return false } clientID = sorg.id.substring(0, sorg.id.lastIndexOf("_")) } else { clientID = cid } if (eval(clientID + "Recursive") == true && force == null) { return } eval(clientID + "Recursive = true;"); var Nanno; var Nmese; var Ngiorno; var NHours; var NMinutes; var NSeconds; var CurrDate = eval(clientID + "_Curr"); var CurrDay = CurrDate.getDate(); var CurrMonth = CurrDate.getMonth(); var CurrYear = CurrDate.getFullYear(); var CurrHours = CurrDate.getHours(); var CurrMinutes = CurrDate.getMinutes(); var CurrSeconds = CurrDate.getSeconds(); var currMin = eval(clientID + "_MinDate"); var currMax = eval(clientID + "_MaxDate"); var dynamicMin = null; if (eval("(typeof " + clientID + "_ClientDynamicMin !== 'undefined') && (" + clientID + "_ClientDynamicMin != null)") == true) { dynamicMin = eval(clientID + "_ClientDynamicMin()") } var dynamicMax = null; if (eval("(typeof " + clientID + "_ClientDynamicMax !== 'undefined') && (" + clientID + "_ClientDynamicMax != null)") == true) { dynamicMax = eval(clientID + "_ClientDynamicMax()") } if (dynamicMin != null && (currMin == null || dynamicMin > currMin)) { if (currMax != null && dynamicMin > currMax) { currMin = currMax } else { currMin = dynamicMin } } if (dynamicMax != null && (currMax == null || dynamicMax < currMax)) { if (currMin != null && dynamicMax < currMin) { currMax = currMin } else { currMax = dynamicMax } } if (document.getElementById(clientID + "_Year") != null) { Nanno = document.getElementById(clientID + "_Year").value } else { Nanno = CurrYear } if (document.getElementById(clientID + "_Month") != null) { Nmese = document.getElementById(clientID + "_Month").value } else { Nmese = CurrMonth } if (document.getElementById(clientID + "_Day") != null) { Ngiorno = document.getElementById(clientID + "_Day").value } else { Ngiorno = CurrDay } if (document.getElementById(clientID + "_Hours") != null) { NHours = document.getElementById(clientID + "_Hours").value } else { NHours = CurrHours } if (document.getElementById(clientID + "_Minutes") != null) { NMinutes = document.getElementById(clientID + "_Minutes").value } else { NMinutes = CurrMinutes } if (document.getElementById(clientID + "_Seconds") != null) { NSeconds = document.getElementById(clientID + "_Seconds").value } else { NSeconds = CurrSeconds } var TempNewDate = new Date(Nanno, Nmese - 1, Ngiorno, NHours, NMinutes, NSeconds); if (currMax != null && currMax < TempNewDate) { TempNewDate = currMax } if (currMin != null && currMin > TempNewDate) { TempNewDate = currMin } Nanno = TempNewDate.getFullYear() + ""; Nmese = (TempNewDate.getMonth() + 1) + ""; Ngiorno = TempNewDate.getDate() + ""; NHours = TempNewDate.getHours() + ""; NMinutes = TempNewDate.getMinutes() + ""; NSeconds = TempNewDate.getSeconds() + ""; var NewYear; var NewMonth; var NewDay; var NewHours; var NewMinutes; var NewSeconds; var MaxYear; var MinYear; var MaxMonth; var MinMonth; var MinDay; var MaxDay; var MinHours; var MaxHours; var MinMinutes; var MaxMinutes; var MinSeconds; var MaxSeconds; eval(clientID + "_Valid = true"); NewYear = parseInt(Nanno); if (!isNaN(NewYear)) { if (currMax == null) { MaxYear = null } else { MaxYear = currMax.getFullYear() } if (currMin == null) { MinYear = null } else { MinYear = currMin.getFullYear() } if (MaxYear != null && MaxYear < NewYear) { NewYear = MaxYear } if (MinYear != null && MinYear > NewYear) { NewYear = MinYear } if (document.getElementById(clientID + "_Year") != null && !eval(clientID + "_DateHidden") && !eval(clientID + "_DateInCalendar")) { DateTimeAdjustYears(document.getElementById(clientID + "_Year"), MinYear, MaxYear) } if ((MaxYear == null || MaxYear >= NewYear) && (MinYear == null || MinYear <= NewYear)) { MaxMonth = 11; MinMonth = 0; if (MaxYear == NewYear) { MaxMonth = currMax.getMonth() } if (MinYear == NewYear) { MinMonth = currMin.getMonth() } NewMonth = parseInt(Nmese); if (!isNaN(NewMonth)) { NewMonth = NewMonth - 1; if (MinMonth > NewMonth) { NewMonth = MinMonth } if (MaxMonth < NewMonth) { NewMonth = MaxMonth } if (init || CurrYear == MinYear || CurrYear == MaxYear || NewYear == MinYear || NewYear == MaxYear) { if (document.getElementById(clientID + "_Month") != null && !eval(clientID + "_DateHidden") && !eval(clientID + "_DateInCalendar")) { DateTimeAdjustMonthes(document.getElementById(clientID + "_Month"), MinMonth, MaxMonth) } } MinDay = 1; MaxDay = DateInputGetNumDays(NewMonth, NewYear); if (MaxYear == NewYear && MaxMonth == NewMonth) { MaxDay = currMax.getDate() } if (MinYear == NewYear && MinMonth == NewMonth) { MinDay = currMin.getDate() } NewDay = parseInt(Ngiorno); if (!isNaN(NewDay)) { if (MinDay > NewDay) { NewDay = MinDay } if (MaxDay < NewDay) { NewDay = MaxDay } if (document.getElementById(clientID + "_Day") != null && !eval(clientID + "_DateHidden") && !eval(clientID + "_DateInCalendar")) { DateTimeAdjustDays(document.getElementById(clientID + "_Day"), MinDay, MaxDay) } MinHours = 0; MaxHours = 23; if (MaxYear == NewYear && MaxMonth == NewMonth && NewDay == MaxDay) { MaxHours = currMax.getHours() } if (MinYear == NewYear && MinMonth == NewMonth && NewDay == MinDay) { MinHours = currMin.getHours() } NewHours = parseInt(NHours); if (!isNaN(NewHours)) { if (MaxHours < NewHours) { NewHours = MaxHours } if (NewHours < MinHours) { NewHours = MinHours } if (document.getElementById(clientID + "_Hours") != null) { DateTimeAdjustTimeElement(document.getElementById(clientID + "_Hours"), MinHours, MaxHours) } MinMinutes = 0; MaxMinutes = 59; if (MaxYear == NewYear && MaxMonth == NewMonth && NewDay == MaxDay && MaxHours == NewHours) { MaxMinutes = currMax.getMinutes() } if (MinYear == NewYear && MinMonth == NewMonth && NewDay == MinDay && MinHours == NewHours) { MinMinutes = currMin.getMinutes() } NewMinutes = parseInt(NMinutes); if (!isNaN(NewMinutes)) { if (MaxMinutes < NewMinutes) { NewMinutes = MaxMinutes } if (MinMinutes > NewMinutes) { NewMinutes = MinMinutes } if (document.getElementById(clientID + "_Minutes") != null) { DateTimeAdjustTimeElement(document.getElementById(clientID + "_Minutes"), MinMinutes, MaxMinutes) } MinSeconds = 0; MaxSeconds = 59; if (MaxYear == NewYear && MaxMonth == NewMonth && NewDay == MaxDay && MaxHours == NewHours && MaxMinutes == NewMinutes) { MaxSeconds = currMax.getSeconds() } if (MinYear == NewYear && MinMonth == NewMonth && NewDay == MinDay && MinHours == NewHours && MinMinutes == NewMinutes) { MinSeconds = currMin.getSeconds() } NewSeconds = parseInt(NSeconds); if (!isNaN(NewSeconds)) { if (MaxSeconds < NewSeconds) { NewSeconds = MaxSeconds } if (NewSeconds < MinSeconds) { NewSeconds = MinSeconds } if (document.getElementById(clientID + "_Seconds") != null) { DateTimeAdjustTimeElement(document.getElementById(clientID + "_Seconds"), MinSeconds, MaxSeconds) } } else { eval(clientID + "_Valid = false") } } else { eval(clientID + "_Valid = false") } } else { eval(clientID + "_Valid = false") } } else { eval(clientID + "_Valid = false") } } else { eval(clientID + "_Valid = false") } } } else { eval(clientID + "_Valid = false") } if (eval(clientID + "_DateInCalendar")) { DateTimeInput_UpdateCalendarMinMax(clientID, currMin, currMax) } var AChange = false; if (eval(clientID + "_Valid")) { if (update == true || (cid == null && (CurrYear != NewYear || CurrMonth != NewMonth || CurrDay != NewDay || CurrHours != NewHours || CurrMinutes != NewMinutes || CurrSeconds != NewSeconds))) { AChange = true } CurrYear = NewYear; CurrMonth = NewMonth; CurrDay = NewDay; CurrHours = NewHours; CurrMinutes = NewMinutes; CurrSeconds = NewSeconds } if (!AChange) { eval(clientID + "Recursive = false;"); return true } eval(clientID + "_Curr = new Date(CurrYear, CurrMonth, CurrDay, CurrHours, CurrMinutes, CurrSeconds)"); if (document.getElementById(clientID + "_Year") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Year", CurrYear) } if (document.getElementById(clientID + "_Month") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Month", CurrMonth + 1) } if (document.getElementById(clientID + "_Day") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Day", CurrDay) } if (eval(clientID + "_DateInCalendar")) { DateTimeInput_UpdateCalendar(clientID) } if (document.getElementById(clientID + "_Hours") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Hours", CurrHours) } if (document.getElementById(clientID + "_Minutes") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Minutes", CurrMinutes) } if (document.getElementById(clientID + "_Seconds") != null) { MvcControlsToolKit_SetDateElement(clientID + "_Seconds", CurrSeconds) } var currDate = eval(clientID + "_Curr"); RefreshDependencies(clientID); eval(clientID + "_ClientDateChanged(" + currDate.getTime() + ")"); $("#" + clientID + "_Hidden").trigger("DateTimeInput_Changed"); eval(clientID + "Recursive = false;"); return true } function MvcControlsToolKit_SetDateElement(d, c) { var b = document.getElementById(d); if (b.tagName == "SELECT") { c = parseInt(c); for (var a = b.options.length - 1; a >= 0; a--) { if (parseInt(b.options[a].value) <= c) { b.selectedIndex = a; return } } b.selectedIndex = 0 } else { if ((c === null) || (c === undefined)) { c = "" } b.value = c } } function SetDateInput(id, value, cType) { if (eval("typeof " + id + "_Curr === 'undefined'") == true) { return } var currDate = eval(id + "_Curr"); if (currDate == null) { return } var currDateInMilliseconds = currDate.getTime(); if (cType == 1 && value >= currDateInMilliseconds) { return } if (cType == 2 && value <= currDateInMilliseconds) { return } var DateInFormat = new Date(value); var currMin = eval(id + "_MinDate"); var currMax = eval(id + "_MaxDate"); if (currMin != null && DateInFormat < currMin) { DateInFormat = currMin } if (currMax != null && DateInFormat > currMax) { DateInFormat = currMax } if (document.getElementById(id + "_Hours") != null) { if (document.getElementById(id + "_Year") != null) { MvcControlsToolKit_SetDateElement(id + "_Year", DateInFormat.getFullYear()); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Month") != null) { MvcControlsToolKit_SetDateElement(id + "_Month", DateInFormat.getMonth() + 1); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Day") != null) { MvcControlsToolKit_SetDateElement(id + "_Day", DateInFormat.getDate()); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Hours") != null) { MvcControlsToolKit_SetDateElement(id + "_Hours", DateInFormat.getHours()); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Minutes") != null) { MvcControlsToolKit_SetDateElement(id + "_Minutes", DateInFormat.getMinutes()); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Seconds") != null) { MvcControlsToolKit_SetDateElement(id + "_Seconds", DateInFormat.getSeconds()); DateInputChanged(null, id, true, true) } } else { if (document.getElementById(id + "_Year") != null) { MvcControlsToolKit_SetDateElement(id + "_Year", DateInFormat.getFullYear()); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Month") != null) { MvcControlsToolKit_SetDateElement(id + "_Month", DateInFormat.getMonth() + 1); DateInputChanged(null, id, false, true) } if (document.getElementById(id + "_Day") != null) { MvcControlsToolKit_SetDateElement(id + "_Day", DateInFormat.getDate()); DateInputChanged(null, id, true, true) } } if (eval(id + "_DateInCalendar")) { DateTimeInput_UpdateCalendar(id) } } function GetDateInput(id) { return eval(id + "_Curr") } function MvcControlsToolkit_DateTimeInput_SetString(b, c) { clientID = b.id.substring(0, b.id.lastIndexOf("_")); var a = null; if (c == null || c == "") { a = new Date() } else { a = MvcControlsToolkit_Parse(c, MvcControlsToolkit_DataType_DateTime) } SetDateInput(clientID, a.getTime(), 3) } function MvcControlsToolkit_DateTimeInput_Set(sorg, value, format, valueType) { clientID = sorg.id.substring(0, sorg.id.lastIndexOf("_")); if ($("#" + sorg.id).length == 0 || eval("typeof " + clientID + "_Curr") === "undefined" || (!($("#" + clientID + "_Hidden").data("ready") || false))) { var retry = function () { MvcControlsToolkit_DateTimeInput_Set(sorg, value, format, valueType) }; setTimeout(retry, 0); return } if (value == null || value == "") { value = new Date() } SetDateInput(clientID, value.getTime(), 3) } function MvcControlsToolkit_DateTimeInput_SetById(d, a, b, c) { if (a == null || a == "") { a = new Date() } SetDateInput(d + "__", a.getTime(), 3) } function MvcControlsToolkit_DateTimeInput_Get(sorg, valueType) { clientID = sorg.id.substring(0, sorg.id.lastIndexOf("_")); if (eval("typeof " + clientID + "_Curr") === "undefined") { return null } if (!($("#" + clientID + "_Hidden").data("ready") || false)) { return null } return eval(clientID + "_Curr") } function MvcControlsToolkit_DateTimeInput_GetById(id, valueType) { return eval(id + "___Curr") } function MvcControlsToolkit_DateTimeInput_BindChange(b, a) { $("#" + b + "___Hidden").bind("DateTimeInput_Changed", a) } function MvcControlsToolkit_DateTimeInput_UnbindChange(b, a) { $("#" + b + "___Hidden").unbind("DateTimeInput_Changed", a) } function MvcControlsToolkit_DateTimeInput_GetString(a) { clientID = a.id.substring(0, a.id.lastIndexOf("_")); return MvcControlsToolkit_Format(GetDateInput(clientID), "s", MvcControlsToolkit_DataType_DateTime, "", "") } function AddToUpdateList(id, toAdd) { if (id == null || toAdd == null) { return } var currIndex = eval(id + "_UpdateListIndex"); eval(id + "_UpdateList[" + currIndex + "] = '" + toAdd + "';"); currIndex++; eval(id + "_UpdateListIndex = " + currIndex + ";") } function RefreshDependencies(id) { if (eval("typeof " + id + "_UpdateListIndex === 'undefined'") == true) { return } var length = eval(id + "_UpdateListIndex"); if (length == null) { return } for (var i = 0; i < length; i++) { DateInputChanged(null, eval(id + "_UpdateList[" + i + "]"), true) } } function MvcControlsToolkit_changeData(b, a, c) { this.ItemChanged = b; this.ChangeType = a; this.Data = c } MvcControlsToolkit_changeData.prototype = { ItemChanged: null, ChangeType: null, Data: null, Cancel: false }; var DataButtonCancel = "DataButtonCancel"; var DataButtonDelete = "DataButtonDelete"; var DataButtonUndelete = "DataButtonUndelete"; var DataButtonEdit = "DataButtonEdit"; var DataButtonInsert = "DataButtonInsert"; var DataButtonResetRow = "DataButtonResetRow"; var DisplayPostfix = "_Display"; var EditPostfix = "_Edit"; var OldEditPostfix = "_OldEdit"; var UndeletePostfix = "_Undelete"; var ChangedExternallyPostfix = "_ChangedExternally"; var SavePostFix = "_Save"; var SavePostFixCurr = "_SaveCurr"; var DatagridFielsdPostfix = "_Datagrid_Fields"; var SavePostFixD = "_SaveD"; var SavePostFixU = "_SaveU"; var SavePostFixC = "_SaveC"; var DeletedPostFix = "_Deleted"; var ContainerPostFix = "_Container"; var VarPostfix = "_Var"; var AllNormalPostfix = "_AllNormal"; var ChandedPostfix = "_Changed"; var TemplateVarsPostfix = "_templateVars"; var TemplatePreparePostfix = "_templatePrepare"; var PlaceHolderPostfix = "_placeHolder"; var ChangedHiddenPostfix = "_changedHidden"; var TemplateSymbolPostfix = "_templateSymbol"; var LastIndexPostfix = "_lastIndex"; var DataGrid_ValidationTypePostfix = "_validationType"; var MinLastIndexPostfix = "_minLastIndex"; var LastVisibleIndexPostfix = "_lastVisibleIndex"; var TemplateEditHtmlPostfix = "_editHtml"; var TemplateDisplayHtmlPostfix = "_displayHtml"; var TemplateAllJavascriptPostfix = "_allJavascript"; var MvcControlsToolkit_DatagridCssPostfix = "_Css"; var MvcControlsToolkit_DatagridAltCssPostfix = "_AltCss"; var MvcControlsToolkit_DatagridFatherItemsPostfix = "_FatherItems"; function DataGrid_Field(original, current, validationType) { this.Original = original; this.Current = current; this.ValidationType = validationType; if (this.Original != null) { var attr = $(this.Original).attr("data-element-type"); if (attr != undefined && attr != null) { this.ControlType = attr; var cnode = this.Original; if (attr == "DateTimeInput") { this.Original = eval(" MvcControlsToolkit_" + attr + "_Get(cnode, null)") } else { this.Original = eval(" MvcControlsToolkit_" + attr + "_GetString(cnode)") } } } } DataGrid_Field.prototype = { Original: null, Current: null, ControlType: null, ValidationType: null, Reset: function () { if (this.Original == null) { return } if (this.Current == null) { return } if (this.ControlType != null) { var cnode = this.Current; var attr = this.ControlType; var cvalue = this.Original; if (attr == "DateTimeInput") { eval(" MvcControlsToolkit_" + attr + "_Set(cnode, cvalue, null, null);") } else { eval(" MvcControlsToolkit_" + attr + "_SetString(cnode, cvalue);") } return } if (this.Original.nodeName.toLowerCase() == "input") { var iType = this.Original.getAttribute("type").toLowerCase(); if (iType == "checkbox" || iType == "radio") { this.Current.checked = this.Original.checked } else { if (iType != "file" && iType != "button" && iType != "reset" && iType != "submit" && iType != "image") { try { this.Current.value = this.Original.value } catch (e) { } } } } else { if (this.Original.nodeName.toLowerCase() == "textarea") { this.Current.value = this.Original.value } else { if (this.Original.nodeName.toLowerCase() == "select") { $(this.Current).html($(this.Original).html()) } } } MvcControlsToolkit_RefreshWidget(this.Current) } }; function DataGrid_EditRowFields(a) { this.Names = new Array(); this.Dictionary = new Array(); this.ValidationType = a } DataGrid_EditRowFields.prototype = { Names: null, Dictionary: null, ValidationType: null, AddOriginal: function (b, a) { if (typeof this.Dictionary[b] === "undefined") { this.Names.push(b); this.Dictionary[b] = new DataGrid_Field(a, null, this.ValidationType) } else { this.Dictionary[b].Original = a } }, AddCurrent: function (b, a) { if (typeof this.Dictionary[b] === "undefined") { this.Names.push(b); this.Dictionary[b] = new DataGrid_Field(null, a, this.ValidationType) } else { this.Dictionary[b].Current = a } }, Reset: function () { var b = null; for (var a = 0; a < this.Names.length; a++) { b = this.Names[a]; if (typeof this.Dictionary[b] !== "undefined") { this.Dictionary[b].Reset() } } } }; function DataGrid_ResetRow(itemRoot) { var fields = null; var temp = null; var validationType = null; var root = itemRoot.substring(0, itemRoot.lastIndexOf("___")); root = root.substring(0, root.lastIndexOf("___")); validationType = eval(root + DataGrid_ValidationTypePostfix); fields = eval(itemRoot + DatagridFielsdPostfix); if (fields == null) { fields = new DataGrid_EditRowFields(validationType); eval(itemRoot + DatagridFielsdPostfix + " = fields;"); temp = eval(itemRoot + SavePostFix); temp.find("input:not([data-elementispart])").each(function (i) { fields.AddOriginal(this.id, this) }); temp.find("textarea:not([data-elementispart])").each(function (i) { fields.AddOriginal(this.id, this) }); temp.find("select:not([data-elementispart])").each(function (i) { fields.AddOriginal(this.id, this) }); temp.find("[data-element-type]").each(function (i) { fields.AddOriginal(this.id, this) }); temp = eval(itemRoot + SavePostFixCurr); temp.find("input:not([data-elementispart])").each(function (i) { fields.AddCurrent(this.id, this) }); temp.find("textarea:not([data-elementispart])").each(function (i) { fields.AddCurrent(this.id, this) }); temp.find("select:not([data-elementispart])").each(function (i) { fields.AddCurrent(this.id, this) }); temp.find("[data-element-type]").each(function (i) { fields.AddCurrent(this.id, this) }); eval(itemRoot + SavePostFix + " = null;") } fields.Reset(); var currRow = eval(itemRoot + SavePostFixCurr); currRow.find(".input-validation-error").removeClass("input-validation-error"); currRow.find(".field-validation-error").removeClass("field-validation-error").addClass("field-validation-valid") } function DataGrid_Remove_Edit_Item(itemRoot) { var temp = null; temp = $("#" + itemRoot + EditPostfix + ContainerPostFix).detach(); if (temp.length != 0) { eval(itemRoot + SavePostFixCurr + " = temp;") } } function DataGrid_Display_Edit_Item(itemRoot) { var temp = null; temp = eval(itemRoot + SavePostFixCurr); $("#" + itemRoot + DisplayPostfix + ContainerPostFix).before(temp); DataGrid_ResetRow(itemRoot) } function DataGrid_ItemRoot_AtIndex(c, a) { var b = c.substring(c.lastIndexOf("___")); var d = c.substring(0, c.lastIndexOf("___")); d = d.substring(0, d.lastIndexOf("_") + 1); return d + a + b } function DataGrid_ItemRoot_Index(a) { a = a.substring(0, a.lastIndexOf("___")); a = a.substring(a.lastIndexOf("_") + 1); return parseInt(a) } function DataGrid_ChecKInsertNewItem(itemRoot) { var root = itemRoot.substring(0, itemRoot.lastIndexOf("___")); root = root.substring(0, root.lastIndexOf("___")); if (eval("typeof " + root + LastIndexPostfix + " === 'undefined'")) { return } var index = DataGrid_ItemRoot_Index(itemRoot); var visibleIndex = eval(root + LastVisibleIndexPostfix); if (index != visibleIndex) { return } var lastIndex = eval(root + LastIndexPostfix); if (lastIndex == index) { index++; var indexStr = index + ""; var templateSymbol = eval(root + TemplateSymbolPostfix); var displayTemplate = eval(root + TemplateDisplayHtmlPostfix).replace(templateSymbol, indexStr); var editTemplate = eval(root + TemplateEditHtmlPostfix).replace(templateSymbol, indexStr); var changed = $("<div>").append($("#" + eval(root + ChangedHiddenPostfix)).clone()).remove().html().replace(templateSymbol, indexStr); var placeHolderName = eval(root + PlaceHolderPostfix); var placeHolder = $("<div>").append($("#" + placeHolderName).clone()).remove().html().replace(templateSymbol, indexStr); var tableRoot = $("#" + itemRoot + EditPostfix + ContainerPostFix).parent(); $(displayTemplate).appendTo(tableRoot); $(editTemplate).appendTo(tableRoot); jQuery.globalEval(eval(root + TemplateAllJavascriptPostfix).replace(templateSymbol, indexStr)); var hiddenElementsFather = $("#" + placeHolderName).parent(); hiddenElementsFather.append(placeHolder); hiddenElementsFather.append(changed); var newItemName = DataGrid_ItemRoot_AtIndex(itemRoot, index) + EditPostfix + ContainerPostFix; if (typeof $ !== "undefined" && $ !== null && typeof $.validator !== "undefined" && $.validator !== null && typeof $.validator.unobtrusive !== "undefined" && $.validator.unobtrusive !== null) { jQuery.validator.unobtrusive.parseExt("#" + newItemName) } var initVars = eval(root + TemplateVarsPostfix).replace(templateSymbol, indexStr); jQuery.globalEval(initVars); var changeData = new MvcControlsToolkit_changeData($("#" + newItemName), "NewHtmlCreated", 0); tableRoot.trigger("itemChange", changeData); var initCall = eval(root + TemplatePreparePostfix).replace(templateSymbol, indexStr); jQuery.globalEval(initCall); visibleIndex++; lastIndex++; eval(root + LastVisibleIndexPostfix + " = visibleIndex;"); eval(root + LastIndexPostfix + " = lastIndex;") } else { index++; var nextItem = DataGrid_ItemRoot_AtIndex(itemRoot, index); var temp = eval(nextItem + SavePostFixD); $("#" + nextItem + DisplayPostfix + ContainerPostFix).replaceWith(temp.clone(true)); eval(root + LastVisibleIndexPostfix + " = index;") } } function DataGrid_ChecKDisappearItem(itemRoot) { var root = itemRoot.substring(0, itemRoot.lastIndexOf("___")); root = root.substring(0, root.lastIndexOf("___")); if (eval("typeof  " + root + LastIndexPostfix + " === 'undefined'")) { return } var index = DataGrid_ItemRoot_Index(itemRoot); var visibleIndex = eval(root + LastVisibleIndexPostfix); var minIndex = eval(root + MinLastIndexPostfix); if (index < minIndex) { return } if (index != visibleIndex) { $("#" + itemRoot + DisplayPostfix + ContainerPostFix).css("display", "none"); if (index == visibleIndex - 1) { index++; itemRoot = DataGrid_ItemRoot_AtIndex(itemRoot, index); DataGrid_ChecKDisappearItem(itemRoot); return } else { return } } var display = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); if (display.length == 0) { return } if (index <= minIndex) { display.css("display", ""); return } var prevItem = DataGrid_ItemRoot_AtIndex(itemRoot, index - 1); if ($("#" + prevItem + DisplayPostfix + ContainerPostFix).length == 0) { return } display.css("display", "none"); visibleIndex--; eval(root + LastVisibleIndexPostfix + " = visibleIndex"); index--; var prevtItem = DataGrid_ItemRoot_AtIndex(itemRoot, index); DataGrid_ChecKDisappearItem(prevItem, root) } function MvcControlsToolkit_Grid_ItemName(c) { var b = c.id; var a = b.lastIndexOf("_"); if (a < 0) { return null } b = b.substring(0, a); a = b.lastIndexOf("_"); if (a < 0) { return null } return b.substring(0, a) + "_Container" } function MvcControlsToolkit_DataButton_Click(c, d) { if (typeof (c) != "string") { c = MvcControlsToolkit_Grid_ItemName(c) } var b = c.lastIndexOf("_"); if (b < 0) { return null } c = c.substring(0, b); b = c.lastIndexOf("_"); if (b < 0) { return null } var a = c.substring(0, b) + "_Changed"; DataButton_Click(c, a, d) } function DataButton_Click(itemRoot, itemChanged, dataButtonType) { if (dataButtonType == DataButtonDelete) { var undel = eval(itemRoot + SavePostFixU); var jItem = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(jItem, "ItemDeleting", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } if (undel != null) { jItem.before(undel.clone(true)); jItem.remove() } else { jItem.css("display", "none") } DataGrid_Remove_Edit_Item(itemRoot); $("#" + itemChanged).val("True"); eval(itemRoot + DeletedPostFix + " = true;"); changeData = new MvcControlsToolkit_changeData(jItem, "ItemDeleted", 0); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); jParent.trigger("itemChange", changeData) } else { if (dataButtonType == DataButtonEdit) { var jItem = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(jItem, "ItemGoingEdit", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } DataGrid_Display_Edit_Item(itemRoot); jItem.remove(); $("#" + itemChanged).val("True"); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); changeData = new MvcControlsToolkit_changeData($("#" + itemRoot + EditPostfix + ContainerPostFix), "ItemGoneEdit", 0); jParent.trigger("itemChange", changeData) } else { if (dataButtonType == DataButtonInsert) { var jItem = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(null, "ItemCreating", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } DataGrid_Display_Edit_Item(itemRoot); jItem.remove(); $("#" + itemChanged).val("True"); DataGrid_ChecKInsertNewItem(itemRoot); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); changeData = new MvcControlsToolkit_changeData($("#" + itemRoot + EditPostfix + ContainerPostFix), "ItemCreated", 0); jParent.trigger("itemChange", changeData) } else { if (dataButtonType == DataButtonCancel) { var jItem = $("#" + itemRoot + EditPostfix + ContainerPostFix); if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(jItem, "ItemUndoing", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } var temp = eval(itemRoot + SavePostFixD); jItem.before(temp.clone(true)); DataGrid_Remove_Edit_Item(itemRoot); $("#" + itemChanged).val("False"); DataGrid_ChecKDisappearItem(itemRoot); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); changeData = new MvcControlsToolkit_changeData($("#" + itemRoot + DisplayPostfix + ContainerPostFix), "ItemUndone", 0); jParent.trigger("itemChange", changeData) } else { if (dataButtonType == DataButtonResetRow) { var jItem = $("#" + itemRoot + EditPostfix + ContainerPostFix); if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(jItem, "ItemResetting", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } var temp = eval(itemRoot + SavePostFixD); $("#" + itemRoot + EditPostfix + ContainerPostFix).before(temp.clone(true)); DataGrid_Remove_Edit_Item(itemRoot); DataGrid_Display_Edit_Item(itemRoot); $("#" + itemRoot + DisplayPostfix + ContainerPostFix).remove(); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); changeData = new MvcControlsToolkit_changeData(jItem, "ItemReset", 0); jParent.trigger("itemChange", changeData) } else { if (dataButtonType == DataButtonUndelete) { var undel = eval(itemRoot + SavePostFixU); var jItem = null; if (undel != null) { jItem = $("#" + itemRoot + UndeletePostfix + ContainerPostFix) } else { jItem = $("#" + itemRoot + DisplayPostfix + ContainerPostFix) } if (jItem.length == 0) { return } var jParent = jItem.parent(); var changeData = new MvcControlsToolkit_changeData(null, "ItemUndeleting", 0); jParent.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } var temp = eval(itemRoot + SavePostFixD); if (undel != null) { jItem.before(temp.clone(true)); jItem.remove() } else { jItem.replaceWith(temp.clone(true)) } eval(itemRoot + DeletedPostFix + " = false;"); $("#" + itemChanged).val("False"); MvcControlsToolkit_DataGridApplyStylesItem(itemRoot); changeData = new MvcControlsToolkit_changeData($("#" + itemRoot + DisplayPostfix + ContainerPostFix), "ItemUndeleted", 0); jParent.trigger("itemChange", changeData) } } } } } } } function DataGrid_Prepare_Template(itemRoot, itemChanged, deleted, root) { var allJavascript = CollectAllScriptsInelement(itemRoot + EditPostfix + ContainerPostFix) + CollectAllScriptsInelement(itemRoot + DisplayPostfix + ContainerPostFix); eval(root + TemplateAllJavascriptPostfix + " = allJavascript;"); var editTemplateElement = $("#" + itemRoot + EditPostfix + ContainerPostFix); var displayTemplateElement = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); editTemplateElement.find("script").remove(); displayTemplateElement.find("script").remove(); var temp = null; if (editTemplateElement.hasClass("MVCCT_EncodedTemplate")) { temp = editTemplateElement.text() } else { temp = $("<div>").append(editTemplateElement.clone()).remove().html() } eval(root + TemplateEditHtmlPostfix + " = temp;"); if (displayTemplateElement.hasClass("MVCCT_EncodedTemplate")) { temp = displayTemplateElement.text() } else { temp = $("<div>").append(displayTemplateElement.clone()).remove().html() } eval(root + TemplateDisplayHtmlPostfix + " = temp;"); editTemplateElement.remove(); displayTemplateElement.remove() } function MvcControlsToolkit_DataGridApplyStylesItem(b) { var a = b.substring(0, b.lastIndexOf("___")); a = a.substring(0, a.lastIndexOf("___")); MvcControlsToolkit_DataGridApplyStyles(a) } function MvcControlsToolkit_DataGridApplyStyles(rootName) { var root = eval(rootName + MvcControlsToolkit_DatagridFatherItemsPostfix); if (root == null) { return } var css = eval(rootName + MvcControlsToolkit_DatagridCssPostfix); var altCss = eval(rootName + MvcControlsToolkit_DatagridAltCssPostfix); var alt = false; for (i = 0; i < root.childNodes.length; i++) { var nodeId = root.childNodes[i].id; if (nodeId == null) { continue } var end_prefix = nodeId.lastIndexOf("_"); if (end_prefix < 0) { continue } var ending = nodeId.substring(end_prefix); if (ending != ContainerPostFix) { continue } if ($(root.childNodes[i]).css("display") == "none") { continue } if (alt) { if (css != "") { $(root.childNodes[i]).removeClass(css) } if (altCss != "") { $(root.childNodes[i]).addClass(altCss) } } else { if (altCss != "") { $(root.childNodes[i]).removeClass(altCss) } if (css != "") { $(root.childNodes[i]).addClass(css) } } alt = !alt } } function DataGrid_Prepare_Item(itemRoot, itemChanged, deleted, root) { var temp = eval(root + AllNormalPostfix); if (temp == null) { temp = new Array() } temp.push(itemRoot); eval(root + AllNormalPostfix + " = temp"); $("#" + itemRoot + OldEditPostfix + ContainerPostFix).find("script").remove(); temp = $("#" + itemRoot + OldEditPostfix + ContainerPostFix).detach(); $("#" + itemRoot + EditPostfix + ContainerPostFix).find("script").remove(); if (temp.length == 0) { temp = $("#" + itemRoot + EditPostfix + ContainerPostFix).clone(true) } temp.css("display", ""); eval(itemRoot + SavePostFix + " = temp;"); temp = $("#" + itemRoot + DisplayPostfix + ContainerPostFix); temp.find("script").remove(); var parent = temp.parent(); if (parent.length > 0) { parent = parent[0]; eval(root + MvcControlsToolkit_DatagridFatherItemsPostfix + " = parent;") } temp = temp.clone(true); eval(itemRoot + SavePostFixD + " = temp;"); temp.css("display", ""); temp = $("#" + itemRoot + ChangedExternallyPostfix + ContainerPostFix); temp.find("script").remove(); temp = temp.detach(); temp.css("display", ""); if (temp != null && temp.size() == 0) { temp = null } eval(itemRoot + SavePostFixC + " = temp;"); var deletedItem = $("#" + itemRoot + UndeletePostfix + ContainerPostFix); deletedItem.find("script").remove(); temp = deletedItem; if (temp != null && temp.size() == 0) { temp = null } eval(itemRoot + SavePostFixU + " = temp;"); if (deleted) { var editItem = $("#" + itemRoot + EditPostfix + ContainerPostFix); DataGrid_Remove_Edit_Item(itemRoot); editItem.css("display", ""); if (temp == null) { $("#" + itemRoot + DisplayPostfix + ContainerPostFix).css("display", "none") } else { $("#" + itemRoot + DisplayPostfix + ContainerPostFix).remove(); deletedItem.css("display", "") } eval(itemRoot + DeletedPostFix + " = true;") } else { deletedItem = deletedItem.detach(); deletedItem.css("display", ""); var editItem = $("#" + itemRoot + EditPostfix + ContainerPostFix); if (eval(itemChanged + VarPostfix)) { DataGrid_Remove_Edit_Item(itemRoot); $("#" + itemRoot + DisplayPostfix + ContainerPostFix).css("display", "") } else { $("#" + itemRoot + DisplayPostfix + ContainerPostFix).remove() } editItem.css("display", ""); eval(itemRoot + DeletedPostFix + " = false;") } } var SortableList_PermutationUpdateRootPrefix = "_PermutationUpdateRoot"; var SortableList_CanSortPrefix = "_CanSort"; var SortableList_ElementsNumberPrefix = "_ElementsNumber"; var SortableList_TemplateSymbolPrefix = "_TemplateSymbol"; var SortableList_TemplateSriptPrefix = "_TemplateSript"; var SortableList_TemplateHtmlPrefix = "_TemplateHtml"; var SortableList_PermutationPrefix = "_Permutation"; var SortableList_PermutationNamePrefix = ".Permutation"; var SortableList_UpdateModelPrefix = "___"; var SortableList_UpdateModelNamePrefix = ".$$"; var SortableList_UpdateModelFieldsPrefix = "_f_ields"; var SortableList_UpdateModelFieldsNamePrefix = ".f$ields"; var SortableList_ItemsContainerPrefix = "_ItemsContainer"; var SortableList_OriginalElementsNumber = "_OriginalElementsNumber"; var SortableList_TemplateHiddenPrefix = "_TemplateHidden"; var SortableList_TemplateHiddenHtmlPrefix = "_TemplateHiddenHtml"; var SortableList_NamePrefixPrefix = "_NamePrefix"; var SortableList_CssPostFix = "_Css"; var SortableList_AltCssPostFix = "_AltCss"; function MvcControlsToolkit_SortableList_ItemName(a) { return a.id } function MvcControlsToolkit_SortableList_PrepareTemplate(a, b) { MvcControlsToolkit_SortableList_PrepareTemplates(a, [b]) } function MvcControlsToolkit_SortableList_PrepareTemplates(root, templatesId) { eval(root + SortableList_TemplateSriptPrefix + " = new Array();"); eval(root + SortableList_TemplateHtmlPrefix + " = new Array();"); eval(root + SortableList_TemplateHiddenHtmlPrefix + " = new Array();"); for (var i = 0; i < templatesId.length; i++) { var templateId = templatesId[i]; var templateElement = $("#" + templateId); var allJavascript = CollectAllScriptsInelement(templateId); eval(root + SortableList_TemplateSriptPrefix + "[i] = allJavascript;"); $("#" + templateId).find("script").remove(); var temp = null; if (templateElement.hasClass("MVCCT_EncodedTemplate")) { temp = templateElement.text() } else { temp = $("<div>").append(templateElement.clone()).remove().html() } eval(root + SortableList_TemplateHtmlPrefix + "[i] = temp;"); var hidden = eval(root + SortableList_TemplateHiddenPrefix); if (hidden.constructor == Array) { hidden = eval(root + SortableList_TemplateHiddenPrefix + "[i]") } temp = $("<div>").append($("#" + hidden).clone()).remove().html(); eval(root + SortableList_TemplateHiddenHtmlPrefix + "[i] = temp;"); $("#" + templateId).remove() } var canSort = eval(root + SortableList_CanSortPrefix); if (canSort) { var elementNumber = eval(root + SortableList_ElementsNumberPrefix); var updateModel = document.getElementById(root + SortableList_UpdateModelPrefix + elementNumber); updateModel.setAttribute("id", updateModel.id + "_"); var updateModelFields = document.getElementById(root + SortableList_UpdateModelPrefix + elementNumber + SortableList_UpdateModelFieldsPrefix); updateModelFields.setAttribute("id", updateModelFields.id + "_") } } function MvcControlsToolkit_SortableList_AddNew(a, c, d) { if (typeof (a) != "string") { a = a.id; var b = a.lastIndexOf("_"); a = a.substring(0, b) } MvcControlsToolkit_SortableList_AddNewChoice(a, 0, c, d) } function MvcControlsToolkit_SortableList_AddNewChoice(root, choice, item, after, replace) { if (eval("typeof  " + root + SortableList_ElementsNumberPrefix + " === 'undefined'")) { return } var rootElement = $("#" + root + SortableList_ItemsContainerPrefix); var changeData = new MvcControlsToolkit_changeData(null, "ItemCreating", choice); rootElement.trigger("itemChange", changeData); if (changeData.Cancel == true) { return } var elementNumber = eval(root + SortableList_ElementsNumberPrefix); var originalElementNumber = eval(root + SortableList_OriginalElementsNumber); var templateSymbol = eval(root + SortableList_TemplateSymbolPrefix); if (templateSymbol.constructor == Array) { templateSymbol = eval(root + SortableList_TemplateSymbolPrefix + "[choice]") } var hidden = eval(root + SortableList_TemplateHiddenPrefix); if (hidden.constructor == Array) { hidden = eval(root + SortableList_TemplateHiddenPrefix + "[choice]") } var allJavascript = eval(root + SortableList_TemplateSriptPrefix + "[choice]").replace(templateSymbol, elementNumber + ""); var allHtml = eval(root + SortableList_TemplateHtmlPrefix + "[choice]").replace(templateSymbol, elementNumber + ""); var hiddenElementFather = $("#" + hidden).parent(); var hiddenElement = eval(root + SortableList_TemplateHiddenHtmlPrefix + "[choice]").replace(templateSymbol, elementNumber + ""); var canSort = eval(root + SortableList_CanSortPrefix); var namePrefix = eval(root + SortableList_NamePrefixPrefix); elementNumber++; eval(root + SortableList_ElementsNumberPrefix + " = elementNumber;"); if (canSort) { var permutation = document.getElementById(root + SortableList_PermutationPrefix); permutation.setAttribute("name", namePrefix + SortableList_UpdateModelNamePrefix + elementNumber + ".$" + SortableList_PermutationNamePrefix); var updateModel = document.getElementById(root + SortableList_UpdateModelPrefix + originalElementNumber + "_"); updateModel.setAttribute("name", namePrefix + SortableList_UpdateModelNamePrefix + elementNumber); var updateModelFields = document.getElementById(root + SortableList_UpdateModelPrefix + originalElementNumber + SortableList_UpdateModelFieldsPrefix + "_"); updateModelFields.setAttribute("name", namePrefix + SortableList_UpdateModelNamePrefix + elementNumber + SortableList_UpdateModelFieldsNamePrefix) } hiddenElementFather.append(hiddenElement); var result; if (item == null) { var hasFooter = false; var lastChild = $("#" + root + "_Footer"); if (lastChild.length > 0) { hasFooter = true } if (hasFooter) { result = $(allHtml).insertBefore(lastChild) } else { result = $(allHtml).appendTo(rootElement) } } else { if (after != true) { result = $(allHtml).insertBefore(item) } else { result = $(allHtml).insertAfter(item) } if (replace) { MvcControlsToolkit_Bind(item, result[0]); $(item).remove() } } if (typeof $ !== "undefined" && $ !== null && typeof $.validator !== "undefined" && $.validator !== null && typeof $.validator.unobtrusive !== "undefined" && $.validator.unobtrusive !== null) { jQuery.validator.unobtrusive.parseExt("#" + result[0].id) } jQuery.globalEval(allJavascript); result.data("ScriptsRemoved", true); Update_Permutations_Root(root); if (canSort) { $("#" + root + SortableList_ItemsContainerPrefix).sortable("refresh") } changeData = new MvcControlsToolkit_changeData(result, "ItemCreated", choice); rootElement.trigger("itemChange", changeData); return result } function MvcControlsToolkit_SortableList_ComputeRoot(b) { var a = b.lastIndexOf("___"); if (a < 0) { return null } var c = b.substring(0, a); a = c.lastIndexOf("___"); c = c.substring(0, a); if (a < 0) { return null } return c } function MvcControlsToolkit_SortableListUpdate(c, d) { if (d != c.parent().attr("id")) { return } var f = c.attr("id"); if (f == null) { return } var e = MvcControlsToolkit_SortableList_ComputeRoot(f); Update_Permutations_Root(e); var a = $("#" + e + "_ItemsContainer"); var b = new MvcControlsToolkit_changeData(c, "ItemMoved", 0); a.trigger("itemChange", b) } function Update_Permutations(a) { return Update_Permutations_Root(MvcControlsToolkit_SortableList_ComputeRoot(a)) } function Update_Permutations_Root(rootName) { if (rootName == null) { return } var root = document.getElementById(rootName + "_ItemsContainer"); if (root == null) { return } if (root.childNodes.length > 0 && root.childNodes[root.childNodes.length - 1].nodeType == 1 && root.childNodes[root.childNodes.length - 1].outerHTML != "" && root.childNodes[root.childNodes.length - 1].id == "") { root = root.childNodes[root.childNodes.length - 1] } var field = document.getElementById(rootName + "_Permutation"); var alt = false; var css = eval(rootName + SortableList_CssPostFix); var altCss = eval(rootName + SortableList_AltCssPostFix); for (i = 0; i < root.childNodes.length; i++) { var currNode = root.childNodes[i]; var jCurrNode = $(currNode); var prova = jCurrNode.data("cavolo") || null; if (jCurrNode.data("ScriptsRemoved") !== true) { CollectScriptAndDestroy(currNode); jCurrNode.data("ScriptsRemoved", true) } var nodeId = root.childNodes[i].getAttribute("id"); if (nodeId == null) { continue } var end_prefix = nodeId.lastIndexOf("_"); if (end_prefix < 0) { continue } var ending = nodeId.substring(end_prefix + 1); if (ending == "Header" || ending == "Footer") { continue } if (alt) { if (css != "") { $(root.childNodes[i]).removeClass(css) } if (altCss != "") { $(root.childNodes[i]).addClass(altCss) } } else { if (altCss != "") { $(root.childNodes[i]).removeClass(altCss) } if (css != "") { $(root.childNodes[i]).addClass(css) } } alt = !alt } if (field == null) { return } var res = ""; for (i = 0; i < root.childNodes.length; i++) { var nodeId = root.childNodes[i].getAttribute("id"); var end_prefix = nodeId.lastIndexOf("_"); if (end_prefix < 0) { continue } var deleteName = nodeId.substring(0, end_prefix + 1) + "Deleted"; var deletedHidden = document.getElementById(deleteName); if (deletedHidden != null && deletedHidden.value == "True") { continue } var end = nodeId.lastIndexOf("___"); var order = nodeId.substring(0, end); var start = order.lastIndexOf("_") + 1; order = order.substring(start); if (i > 0) { res = res + "," } res = res + order } field.value = res } function MvcControlsToolkit_SortableList_Click(target, dataButtonType, noEvents) { if (typeof (target) != "string") { target = target.id } if (dataButtonType == ManipulationButtonCustom) { eval(target); return } var end_prefix = target.lastIndexOf("_"); var deleteName = target.substring(0, end_prefix); end_prefix = deleteName.lastIndexOf("_"); deleteName = deleteName.substring(0, end_prefix + 1) + "Deleted"; var deletedHidden = document.getElementById(deleteName); var rootName = MvcControlsToolkit_SortableList_ComputeRoot(target); var rootElement = $("#" + rootName + SortableList_ItemsContainerPrefix); if (dataButtonType == ManipulationButtonRemove) { var item = $("#" + target); var changeData = new MvcControlsToolkit_changeData(item, "ItemDeleting", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } if (changeData.Cancel == true) { return } item.remove(); Update_Permutations_Root(rootName); changeData = new MvcControlsToolkit_changeData(item, "ItemDeleted", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } } else { if (dataButtonType == ManipulationButtonHide) { var item = $("#" + target); var changeData = new MvcControlsToolkit_changeData(item, "ItemDeleting", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } if (changeData.Cancel == true) { return } var placeHolder = "<span style='display:none' id = '" + target + "_ph' />"; $(placeHolder).insertBefore("#" + target); jQuery.globalEval("var " + deleteName + " = $('#' + '" + target + "').detach();"); if (deletedHidden != null) { deletedHidden.value = "True" } Update_Permutations_Root(rootName); changeData = new MvcControlsToolkit_changeData(item, "ItemDeleted", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } } else { if (dataButtonType == ManipulationButtonShow) { var changeData = new MvcControlsToolkit_changeData(null, "ItemCreating", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } if (changeData.Cancel == true) { return } var toAdd = eval(deleteName); toAdd.find("script").remove(); $(toAdd).insertBefore("#" + target + "_ph"); $("#" + target + "_ph").remove(); if (deletedHidden != null) { deletedHidden.value = "False" } Update_Permutations_Root(rootName); changeData = new MvcControlsToolkit_changeData(toAdd, "ItemCreated", 0); if (noEvents == null) { rootElement.trigger("itemChange", changeData) } } } } } function MvcControlsToolkit_SortableList_Move(c, d, e) { if (e != true) { $(c).insertBefore(d) } else { $(c).insertAfter(d) } var f = MvcControlsToolkit_SortableList_ComputeRoot(c.id); Update_Permutations_Root(f); var a = $("#" + f + "_ItemsContainer"); var b = new MvcControlsToolkit_changeData(c, "ItemMoved", 0); a.trigger("itemChange", b) } var ManipulationButtonRemove = "ManipulationButtonRemove"; var ManipulationButtonHide = "ManipulationButtonHide"; var ManipulationButtonShow = "ManipulationButtonShow"; var ManipulationButtonResetGrid = "ManipulationButtonResetGrid"; var ManipulationButtonCustom = "ManipulationButtonCustom"; function ManipulationButton_Click(target, dataButtonType) { if (dataButtonType == ManipulationButtonCustom) { if (typeof target === "string") { eval(target) } else { target() } return } if (dataButtonType == ManipulationButtonRemove) { $("#" + target).remove() } else { if (dataButtonType == ManipulationButtonHide) { $("#" + target).css("visibility", "hidden") } else { if (dataButtonType == ManipulationButtonShow) { $("#" + target).css("visibility", "visible") } else { if (dataButtonType == ManipulationButtonResetGrid) { var toUndo = eval(target + AllNormalPostfix); if (toUndo != null) { for (var i = 0; i < toUndo.length; i++) { var vChanged = toUndo[i].substring(0, toUndo[i].lastIndexOf("_")) + ChandedPostfix; var deleted = eval(toUndo[i] + DeletedPostFix); if (deleted != null && deleted == true) { DataButton_Click(toUndo[i], vChanged, DataButtonUndelete) } else { DataButton_Click(toUndo[i], vChanged, DataButtonCancel) } } } } } } } } function MvcControlsToolkit_Button_AdjustText(a, c) { var b = document.getElementById(a); var d = b.nodeName.toLowerCase(); if (d == "input") { b.value = c } else { if (d == "img") { b.setAttribute("src", c) } else { if (d == "a") { b.firstChild.nodeValue = c } } } } function PageButton_Click(d, c, e, b, a) { if (e == "") { if (!MvcControlsToolkit_FormIsValid(d, a)) { return } var f = document.getElementById(d); f.value = c; $("#" + d).parents("form").submit() } else { if (b != "") { $.ajax({ type: "GET", url: e, success: function (g) { $("#" + b).html(g) } }) } else { window.location.href = e } } } function MvcControlsToolkit_RefreshPager(d) { var c = function (h, l) { if (!l || l == "curr") { if (l == "curr") { h.attr("data-selected-page", "selected") } else { h.attr("disabled", "disabled"); if (h[0].tagName.toLowerCase() == "img") { var j = h.attr("data-enabled-src") || ""; if (j != "") { h.attr("src") = j } } } h.attr("data-no-click", true) } else { h.removeAttr("disabled"); h.removeAttr("data-selected-page"); if (h[0].tagName.toLowerCase() == "img") { var k = h.attr("data-disabled-src") || ""; if (k != "") { h.attr("src") = k } } h.removeAttr("data-no-click") } }; var b = $("#" + d); var a = parseInt(b.val()); var f = b.attr("data-total-pages") || ""; if (f != "") { f = parseInt(f) } if (a < 1) { a = 1 } var e = b.attr("data-page-prefix") || ""; var g = b.attr("data-page-postfix") || ""; MvcControlsToolkit_TypedTextBox_SetById(d + "_goto", a, null, 1); $("." + d + "_class").each(function () { var k = $(this); var j = k.attr("data-pager-button"); if (j == "PageButtonFirst" || j == "PageButtonPrevious") { if (a == 1) { c(k, false) } else { c(k, true) } } else { if (j == "PageButtonNext") { if (f != "" && a >= f) { c(k, false) } else { c(k, true) } } else { if (j == "PageButtonLast") { if (f == "" || a >= f) { c(k, false) } else { c(k, true) } } else { if (j == "PageButtonPage") { var h = parseInt(k.attr("data-pager-index")); if (a + h < 1 || (f != "" && a + h > f)) { k.parent().hide() } else { k.text(e + (a + h) + g); k.parent().show(); if (h == 0) { c(k, "curr") } else { c(k, true) } } } } } } }) } function MvcControlsToolkit_InitJsonPager(pagerId) { $(document).ready(function () { var pager = $("#" + pagerId); var causeSubmit = (pager.attr("data-cause-submit") || "") != ""; var validationType = pager.attr("data-validation-type") || ""; $("." + pagerId + "_class").click(function () { var jThis = $(this); if ((jThis.attr("data-no-click") || false)) { return false } var type = jThis.attr("data-pager-button"); var prevPage = pager.val(); if (!causeSubmit || MvcControlsToolkit_FormIsValid(pagerId, validationType)) { if (type == "PageButtonFirst") { pager.val(1); pager.trigger("ClientPager_Changed") } else { if (type == "PageButtonPrevious") { var currPage = parseInt(pager.val()); pager.val(currPage - 1); pager.trigger("ClientPager_Changed") } else { if (type == "PageButtonNext") { var currPage = parseInt(pager.val()); pager.val(currPage + 1); pager.trigger("ClientPager_Changed") } else { if (type == "PageButtonLast") { var totPages = pager.attr("data-total-pages") || ""; if (totPages != "") { pager.val(parseInt(totPages)); pager.trigger("ClientPager_Changed") } } else { if (type == "PageButtonPage") { var currPage = parseInt(pager.val()); var index = parseInt(jThis.attr("data-pager-index")); pager.val(currPage + index); pager.trigger("ClientPager_Changed") } else { if (type == "PageButtonGoTo") { var totPages = pager.attr("data-total-pages") || ""; if (totPages != "") { totPages = parseInt(totPages) } var targetPage = MvcControlsToolkit_TypedTextBox_GetById(pagerId + "_goto", 1); if (targetPage < 1) { targetPage = 1 } else { if (totPages != "" && targetPage > totPages) { targetPage = totPages } } pager.val(targetPage); pager.trigger("ClientPager_Changed") } } } } } } } MvcControlsToolkit_RefreshPager(pagerId); var totPages = pager.attr("data-total-pages") || ""; if (totPages != "") { totPages = parseInt(totPages) } var data = { type: "page", submit: causeSubmit, page: parseInt(pager.val()), previousPage: parseInt(prevPage), totalPages: totPages }; pager.trigger("queryChanged", data); if (data.submit) { pager.parents("form").first().submit() } }); var clientModel = pager.attr("data-client-model") || ""; var totalPageName = pager.attr("data-total-pages-name") || ""; if (clientModel != "" && totalPageName != "") { var dependentObservable = new ko.dependentObservable(function () { var pages = ko.utils.unwrapObservable(eval(clientModel + "." + totalPageName)); pager.attr("data-total-pages", pages + ""); MvcControlsToolkit_RefreshPager(pagerId) }, null, { disposeWhenNodeIsRemoved: pager[0] }); pager.data("__mvcct_totalpagesDependency__", dependentObservable) } MvcControlsToolkit_RefreshPager(pagerId) }) } function MvcControlsToolkit_NewPage(c, d, b) { var a = $("#" + c); a.val(d); a.attr("data-total-pages", b); MvcControlsToolkit_RefreshPager(c) } function MvcControlsToolkit_ClientPager_Get(a, b) { return parseInt($(a).val()) } function MvcControlsToolkit_ClientPager_GetString(a) { return $(a).val() } function MvcControlsToolkit_ClientPager_GetById(b, a) { return parseInt($("#" + b).val()) } function MvcControlsToolkit_ClientPager_Set(b, a, c, d) { $(b).val(a); MvcControlsToolkit_RefreshPager(b.id) } function MvcControlsToolkit_ClientPager_SetById(d, a, b, c) { $("#" + d).val(a); MvcControlsToolkit_RefreshPager(d) } function MvcControlsToolkit_ClientPager_SetString(b, a) { $(b).val(a); MvcControlsToolkit_RefreshPager(b.id) } function MvcControlsToolkit_ClientPager_BindChange(b, a) { $("#" + b).bind("ClientPager_Changed", a) } function MvcControlsToolkit_ClientPager_UnbindChange(b, a) { $("#" + b).unbind("ClientPager_Changed", a) } function _inner_Sort_Handler(field, buttonName, initialize, causePostback, clientOrderChanged, sortField, pageField, cssNoSort, cssAscending, cssDescending, validationType, oneColumnSorting) { if (!initialize && causePostback && !MvcControlsToolkit_FormIsValid(sortField, validationType)) { return } var order = $("#" + sortField).val(); var hasAscending = order.indexOf(" " + field + "#+;"); var hasDescending = order.indexOf(" " + field + "#-;"); var prevOrder = ""; var actualOrder = ""; if (!initialize) { if (hasDescending >= 0) { if (oneColumnSorting) { order = order.replace(" " + field + "#-;", " " + field + "#+;") } else { order = order.replace(" " + field + "#-;", "") } $("#" + sortField).val(order); $("#" + buttonName).removeClass(cssDescending); if (oneColumnSorting) { $("#" + buttonName).addClass(cssAscending) } else { $("#" + buttonName).addClass(cssNoSort) } prevOrder = "-" } else { if (hasAscending >= 0) { order = order.replace(" " + field + "#+;", " " + field + "#-;"); $("#" + sortField).val(order); $("#" + buttonName).removeClass(cssAscending); $("#" + buttonName).addClass(cssDescending); prevOrder = "+"; actualOrder = "-" } else { if (oneColumnSorting) { order = " " + field + "#+;" } else { order = order + " " + field + "#+;" } $("#" + sortField).val(order); $("#" + buttonName).removeClass(cssNoSort); $("#" + buttonName).addClass(cssAscending); actualOrder = "+"; if (oneColumnSorting) { var prevButton = eval(sortField); if (prevButton != "" && prevButton != buttonName) { $("#" + prevButton).removeClass(cssDescending).removeClass(cssAscending).addClass(cssNoSort) } eval(sortField + " = buttonName;") } } } if (pageField != null) { $("#" + pageField).val("1") } if (clientOrderChanged != null) { eval(clientOrderChanged + "('" + field + "', '" + prevOrder + "', '" + actualOrder + "')") } if (causePostback) { $("#" + sortField).parents("form").submit() } } else { if (hasDescending >= 0) { $("#" + buttonName).addClass(cssDescending); if (oneColumnSorting) { eval(sortField + " = buttonName;") } } else { if (hasAscending >= 0) { $("#" + buttonName).addClass(cssAscending); if (oneColumnSorting) { eval(sortField + " = buttonName;") } } else { $("#" + buttonName).addClass(cssNoSort) } } } } function Sort_Handler(o, q, d, g, k, l, f, h, e, j, n, m) { var b = $("#" + l); if (!d && g && !MvcControlsToolkit_FormIsValid(l, n)) { return } _inner_Sort_Handler(o, q, d, false, k, l, f, h, e, j, n, m); if (!d) { var c = { type: "sort", sortString: b.val(), submit: g, page: 1 }; if (f != null) { var a = $("#" + f); MvcControlsToolkit_RefreshPager(f); a.trigger("ClientPager_Changed"); var p = a.attr("data-total-pages") || ""; if (p != "") { p = parseInt(p) } c.pageSize = p } b.trigger("queryChanged", c); if (c.submit) { b.parents("form").first().submit() } } } function Setup_Ajax_ClientValidation(d, a) { if (a == ValidationType_StandardClient) { var e = window.mvcClientValidationMetadata; if (e) { for (var b = 0; b < e.length; b++) { var c = e[b]; c.FormId = d } } Sys.Mvc.FormContext._Application_Load() } else { if (typeof $ !== "undefined" && $ !== null && typeof $.validator !== "undefined" && $.validator !== null && typeof $.validator.unobtrusive !== "undefined" && $.validator.unobtrusive !== null) { $.validator.unobtrusive.clearAndParse("#" + d) } } MvcControlsToolkit_ParseRegister.parse("#" + d) } function OnBeginDetailForm(baseName, detailType, rowId, loadingElementId, validationType) { detailBusy = eval(baseName + "_DetailBusy"); if (detailBusy) { return false } eval(baseName + "_DetailBusy = true;"); eval(baseName + "_TypeDetail = '" + detailType + "';"); if (rowId != null) { if (detailType == "Insert") { eval(baseName + "_CurrentRow = null;") } else { eval(baseName + "_CurrentRow = '" + rowId + "';") } } else { var res = MvcControlsToolkit_FormIsValid(loadingElementId, validationType); return res } return true } function OnFailureDetailForm(baseName, displayExecute, editExecute) { var detailType = eval(baseName + "_TypeDetail"); if (detailType == "Display") { if (displayExecute != null) { (displayExecute + "();") } } else { if (editExecute != null) { (editExecute + "();") } } eval(baseName + "_DetailBusy = false;") } function TrueValue(value, fieldName) { var trueValue = value; try { trueValue = eval(fieldName + "_True") } catch (e) { } return trueValue } function FormattedValue(value, fieldName) { var fValue = value; try { fValue = eval(fieldName + "_Format") } catch (e) { } if (fValue != null && fValue.length > 0 && fValue.substring(0, 1) == "<") { fValue = $("#" + fieldName + "_Format").text(); $("#" + fieldName + "_Format").remove() } var companionField = document.getElementById(fieldName + "_hidden"); if (companionField != null) { fValue = companionField.value } return fValue } function UrlValue(fieldName) { var urlValue = null; try { urlValue = eval(fieldName + "_Url") } catch (e) { } return urlValue } function OnSuccessDetailForm(baseName, displayExecute, editExecute, ajaxContext, formId, validationType, unobtrusiveAjaxOn, updateTargetId) { var detailType = eval(baseName + "_TypeDetail"); if (!unobtrusiveAjaxOn) { GlobalEvalScriptAndDestroy(ajaxContext.get_updateTarget()) } else { if (detailType == "Edit") { $("#" + updateTargetId).html(ajaxContext) } } if (validationType != ValidationType_Server) { Setup_Ajax_ClientValidation(formId, validationType) } var detailType = eval(baseName + "_TypeDetail"); var changedFieldCss = eval(baseName + "_ChangedFieldCss"); var deletedRecordCss = eval(baseName + "_DeletedRecordCss"); var isValid = false; var hiddenIsValid = document.getElementById("IsValid"); if (hiddenIsValid != null && hiddenIsValid.value == "True") { isValid = true } var itemRoot = eval(baseName + "_CurrentRow"); if (isValid && (detailType == "FirstEdit" || detailType == "Edit" || detailType == "Display")) { var fieldsToUpdate = eval(baseName + "_FieldsToUpdate").split(","); var detailRoot = eval(baseName + "_DetailPrefix"); if (itemRoot != null) { var oldItemRoot = itemRoot.substring(0, itemRoot.lastIndexOf("Value")) + "OldValue"; var isInsert = true; var isExternalDelete = true; var changedDisplay = eval(itemRoot + SavePostFixC); var changedDisplayAvailable = false; if (changedDisplay == null) { changedDisplay = eval(itemRoot + SavePostFixD) } else { changedDisplayAvailable = true } for (var i = 0; i < fieldsToUpdate.length; i++) { var oField = document.getElementById(oldItemRoot + "_" + fieldsToUpdate[i]); var oFields = document.getElementById(oldItemRoot + "_" + fieldsToUpdate[i] + "___JSonModel"); if (oField == null) { oField = oFields } if (oField != null) { isInsert = false } var newFieldName = null; if (detailRoot.length == 0) { newFieldName = fieldsToUpdate[i] } else { newFieldName = oldItemRoot + "_" + fieldsToUpdate[i] } var newField = document.getElementById(newFieldName); if (newField != null) { isExternalDelete = false } if (oField != null) { var newValue = null; var newFormattedValue = null; if (newField != null && newField.getAttribute("type") != null && (newField.getAttribute("type").toLowerCase() == "checkbox" || newField.getAttribute("type").toLowerCase() == "radio")) { if (newField.getAttribute("checked") != null && newField.checked == true) { newValue = "True" } else { newValue = "False" } newFormattedValue = FormattedValue(newValue, newFieldName) } else { if (newField != null && newField.getAttribute("type") != null && newField.getAttribute("type").toLowerCase() == "file") { } else { if (newField != null) { try { if (newField.nodeName != null && (newField.nodeName.toLowerCase() == "input" || newField.nodeName.toLowerCase() == "textarea")) { newValue = TrueValue(newField.value, newFieldName); newFormattedValue = FormattedValue(newField.value, newFieldName) } else { if (newField.nodeName != null && newField.nodeName.toLowerCase() == "select") { var jNewField = $(newField); newValue = TrueValue(jNewField.val(), newFieldName); if (newValue == "") { newValue = null } newFormattedValue = FormattedValue(jNewField.find("option:selected").text(), newFieldName) } else { newValue = TrueValue(newField.childNodes[0].nodeValue, newFieldName); newFormattedValue = FormattedValue(newField.childNodes[0].nodeValue, newFieldName) } } } catch (e) { } } else { newValue = TrueValue(null, newFieldName); newFormattedValue = FormattedValue(null, newFieldName) } } } var itemToUpdate = changedDisplay.find("#" + itemRoot + "_" + fieldsToUpdate[i]); var originalValue; var jOField = $(oField); if (typeof (jOField.data("originalvalue")) !== "undefined") { originalValue = jOField.data("originalvalue"); if (originalValue == null || originalValue == undefined) { originalValue = oField.value; jOField.data("originalvalue", oField.value) } } else { originalValue = oField.value; jOField.data("originalvalue", oField.value) } if (changedFieldCss != null) { if (newValue != null && originalValue != newValue) { itemToUpdate.removeClass(changedFieldCss); itemToUpdate.addClass(changedFieldCss) } else { itemToUpdate.removeClass(changedFieldCss) } } if (newValue != null && oField.value != newValue) { oField.value = newValue; if (itemToUpdate.length != 0) { var inputType = itemToUpdate.attr("type"); if (inputType != null && inputType != undefined && (inputType.toLowerCase() == "checkbox" || inputType.toLowerCase() == "radio")) { if (newValue.toLowerCase() == "true") { itemToUpdate.checked = true } else { itemToUpdate.checked = false } } else { if (itemToUpdate.filter("img").length > 0) { var imgUrl = UrlValue(newFieldName); if (imgUrl != null) { try { itemToUpdate.attr("src", imgUrl); itemToUpdate.attr("alt", newFormattedValue) } catch (e) { } } } else { try { itemToUpdate.html(newFormattedValue) } catch (e) { } } } } } } } if (isExternalDelete) { $('input[id^="' + oldItemRoot + '"]').remove(); if (deletedRecordCss != null) { var newSavePostFixD = eval(itemRoot + SavePostFixD); newSavePostFixD.addClass(deletedRecordCss); $("#" + itemRoot + DisplayPostfix + ContainerPostFix).replaceWith(newSavePostFixD.clone(true)) } } else { if (!isInsert) { if (changedDisplayAvailable) { eval(itemRoot + SavePostFixD + " = " + itemRoot + SavePostFixC + ";") } var newSavePostFixD = eval(itemRoot + SavePostFixD); $("#" + itemRoot + DisplayPostfix + ContainerPostFix).replaceWith(newSavePostFixD.clone(true)) } } if (itemRoot != null) { MvcControlsToolkit_DataGridApplyStylesItem(itemRoot) } } } if (detailType == "Display") { if (displayExecute != null) { try { eval(displayExecute + "(itemRoot, isValid, detailType);") } catch (e) { } } } else { if (editExecute != null) { try { eval(editExecute + "(itemRoot, isValid, detailType);") } catch (e) { } } } eval(baseName + "_DetailBusy = false;") } function ViewList_Client(groupName, hiddenField, cssSelected, prefix) { this.CssSelected = cssSelected; this.GroupName = groupName; this.HiddenField = hiddenField; this.Prefix = prefix; var allViews = $("." + groupName); allViews.each(function (i) { var name = this.id + "_placeholder"; var thisId = this.id; $("#" + thisId).before("<span style='display:none;' id='" + name + "'></span>"); $("." + thisId + "_checkbox").click(function () { if ($("." + thisId + "_checkbox")[0].checked) { eval(groupName + "_ViewList").Select(thisId, true) } else { eval(groupName + "_ViewList").Select("", true) } }) }); this.SelectionSet = allViews.detach(); this.SelectionSet.find("script").remove() } ViewList_Client.prototype = { HiddenField: null, GroupName: null, CssSelected: null, SelectionSet: null, Prefix: null, Select: function (b, a) { $("." + this.GroupName + "_button").removeClass(this.CssSelected); $("." + this.GroupName + "_checkbox").each(function (c) { this.checked = false }); $("." + this.GroupName).detach(); if (b == "") { document.getElementById(this.HiddenField).value = ""; return } document.getElementById(this.HiddenField).value = b; if (a == null) { b = this.Prefix + b } this.SelectionSet.filter("#" + b).insertBefore("#" + b + "_placeholder"); $("." + b + "_button").addClass(this.CssSelected); $("." + b + "_checkbox").each(function (c) { this.checked = true }) } }; function ViewsOnOff_Client_Switch(groupName, on, hidden) { if (on) { $("." + groupName + "_checkbox").each(function (i) { this.checked = true }); var toAttach = eval(groupName + "_ViewsOnOff"); toAttach.each(function (i) { var currId = this.id; $(this).insertBefore("#" + currId + "_placeholder") }); document.getElementById(hidden).value = "True" } else { $("." + groupName + "_checkbox").each(function (i) { this.checked = false }); $("." + groupName).detach(); document.getElementById(hidden).value = "False" } } function ViewsOnOff_Client_Initialize(groupName, initial_on, hidden) { var allViews = $("." + groupName); allViews.each(function (i) { var prova = this.id; if (this.id == null || this.id == "") { this.id = groupName + "_el" + i } var name = this.id + "_placeholder"; var thisId = this.id; $("#" + this.id).before("<span style='display:none;' id='" + name + "'></span>"); $("." + groupName + "_checkbox").click(function (event) { ViewsOnOff_Client_Switch(groupName, event.target.checked, hidden) }) }); var selectionSet = allViews.detach(); selectionSet.find("script").remove(); eval(groupName + "_ViewsOnOff = selectionSet;"); if (initial_on) { $("." + groupName + "_checkbox").each(function (i) { this.checked = true }); selectionSet.each(function (i) { var currId = this.id; $(this).insertBefore("#" + currId + "_placeholder") }) } else { $("." + groupName + "_checkbox").each(function (i) { this.checked = false }) } } var MvcControlsToolkit_DataType_String = 0; var MvcControlsToolkit_DataType_UInt = 1; var MvcControlsToolkit_DataType_Int = 2; var MvcControlsToolkit_DataType_Float = 3; var MvcControlsToolkit_DataType_DateTime = 4; function MvcControlsToolkit_Format(c, d, a, b, e) { if (a < 0) { return c } if (c == null) { return "" } return b + MvcControlsToolkit_ToString(c, d, a) + e } function MvcControlsToolkit_FormatDisplay(d, e, b, c, f, a) { if (b < 0) { return d } if (d == null || d === "") { return a } return c + MvcControlsToolkit_ToString(d, e, b) + f } function MvcControlsToolkit_ToString(b, c, a) { if (b === undefined) { return undefined } if (a == MvcControlsToolkit_DataType_String || a < 0) { if (b === true) { return "True" } if (b === false) { return "False" } return b } if (b == null) { return "" } if (c == "") { if (a == MvcControlsToolkit_DataType_DateTime) { c = "d" } else { if (a == MvcControlsToolkit_DataType_Int || a == MvcControlsToolkit_DataType_UInt) { c = "d" } else { if (a == MvcControlsToolkit_DataType_Float) { c = "n" } else { return b } } } } if ((typeof jQuery !== "undefined") && (typeof jQuery.global !== "undefined") && (typeof jQuery.global.parseInt === "function")) { if (a == MvcControlsToolkit_DataType_DateTime && c == "s") { c = "S" } return jQuery.global.format(b, c) } else { if ((typeof Number !== "undefined") && (typeof Number.parseLocale === "function")) { if (a == MvcControlsToolkit_DataType_DateTime && c == "S") { c = "s" } return b.localeFormat(c) } else { return b + "" } } } function MvcControlsToolkit_Parse(c, b) { if (b == MvcControlsToolkit_DataType_String) { return c } if (c === undefined) { return undefined } if (c == "") { return null } if (b == MvcControlsToolkit_DataType_Float) { if ((typeof jQuery !== "undefined") && (typeof jQuery.global !== "undefined") && (typeof jQuery.global.parseFloat == "function")) { return jQuery.global.parseFloat(c) } else { if ((typeof Number !== "undefined") && (typeof Number.parseLocale == "function")) { return Number.parseLocale(c) } else { return parseFloat(c) } } } else { if (b == MvcControlsToolkit_DataType_DateTime) { if ((typeof jQuery !== "undefined") && (typeof jQuery.global !== "undefined") && (typeof jQuery.global.parseDate == "function")) { return jQuery.global.parseDate(c) } else { if ((typeof Date !== "undefined") && (typeof Date.parseLocale == "function")) { return Date.parseLocale(c) } else { return Date.parse(c) } } } else { if ((typeof jQuery !== "undefined") && (typeof jQuery.global !== "undefined") && (typeof jQuery.parseInt == "function")) { return jQuery.global.parseInt(c) } else { if (typeof Number.parseLocale == "function") { var a = Number.parseLocale(c); if (isNaN(a)) { return a } return parseInt(a + "") } else { return parseInt(c, 10) } } } } } function MvcControlsToolkit_TypedTextBox_Input(j, d, a, f, h, e, c, b) { if (f == MvcControlsToolkit_DataType_String || f == MvcControlsToolkit_DataType_DateTime || j == 0 || j == 13 || j == 8 || j == e.charCodeAt(0) || (j >= 48 && j <= 57)) { return true } if ((f == MvcControlsToolkit_DataType_Int || f == MvcControlsToolkit_DataType_Float) && (j == c.charCodeAt(0) || j == b.charCodeAt(0))) { var g = document.getElementById(d).value; return g.indexOf(c) < 0 && g.indexOf(b) < 0 } if (f == MvcControlsToolkit_DataType_Float && j == h.charCodeAt(0)) { var g = document.getElementById(d).value; return g.indexOf(h) < 0 } return false } function MvcControlsToolkit_FocusAtEnd(a) { var b = document.getElementById(a); if (b.setSelectionRange) { b.setSelectionRange(b.value.length, b.value.length) } else { if (this.createTextRange) { r = b.createTextRange(); r.collapse(false); r.select() } } } function MvcControlsToolkit_TypedTextBox_Focus(a, c, b) { document.getElementById(a).value = document.getElementById(c).value; if (b != "") { $("#" + a).removeClass(b) } } function MvcControlsToolkit_DisplayEdit_DbClick(a, b) { $("#" + b).hide(); $("#" + a).show().focus() } function MvcControlsToolkit_TypedTextBox_Init(o, n, m, l, k, j, h, g, f, e, d, c, b, a) { $(document).ready(function () { var p = $("#" + o); p.bind("pblur", function () { MvcControlsToolkit_TypedTextBox_Blur(o, n, l, f, e, d, h, g, k, j, c, m, b); return false }); p.bind("pfocus", function () { MvcControlsToolkit_TypedTextBox_Focus(o, n, m); return false }); try { p.trigger("pfocus"); MvcControlsToolkit_TypedTextBox_Blur(o, n, l, f, e, d, h, g, k, j, c, m, b, true) } catch (q) { } p.focus(function () { p.trigger("pfocus"); MvcControlsToolkit_FocusAtEnd(o); return true }); if (a != null) { p.datepicker(a) } if (a != null) { p.datepicker() } p.blur(function () { p.trigger("pblur"); return true }); p.keypress(function (s) { return MvcControlsToolkit_TypedTextBox_Input(s.which, o, n, l, k, j, h, g) }) }) } function MvcControlsToolkit_TypedTextBox_Blur(s, z, q, n, u, v, w, b, f, l, h, j, g, m) { var a = document.getElementById(s); if (a == null) { return } var o = a.value; var p = o; if (q != MvcControlsToolkit_DataType_String && q != MvcControlsToolkit_DataType_DateTime) { o = MvcControlsToolkit_Trim(o); p = o; var d = o; d = d.replace(l, ""); tvalue = d.replace(w, ""); negative = d.indexOf(b); d = d.replace(b, ""); var y = ""; var c = ""; for (var t = 0; t < d.length; t++) { c = d.charCodeAt(t); if ((c >= 48 && c <= 57) || c == f.charCodeAt(0)) { y = y + d.charAt(t) } } d = y; if (o != "") { var k = 0; try { k = MvcControlsToolkit_Parse(d, q); if (negative >= 0) { k = k * -1 } if (!isNaN(k)) { o = MvcControlsToolkit_ToString(k, v, q); if (q == MvcControlsToolkit_DataType_Float) { if (negative >= 0) { p = b + d } else { p = d } } else { p = MvcControlsToolkit_ToString(k, "n0", q) } } } catch (x) { } } } if (q == MvcControlsToolkit_DataType_DateTime) { p = MvcControlsToolkit_ToString(MvcControlsToolkit_Parse(p, q), v, q); o = p } document.getElementById(z).value = p; if (m == null) { MvcControlsToolkit_Validate(z, g); $("#" + z).trigger("vblur") } $("#" + s).removeClass("input-validation-error"); if ($("#" + z).hasClass("input-validation-error")) { $("#" + s).addClass("input-validation-error") } if (o == "") { if (j != "") { $("#" + s).addClass(j) } document.getElementById(s).value = h } else { document.getElementById(s).value = n + o + u } $("#" + s).trigger("TypedTextBox_Changed") } function MvcControlsToolkit_DisplayEdit_Init(p, o, n, m, l, k, j, h, g, f, e, d, c, b, a) { $(document).ready(function () { var q = $("#" + p); if (b != null) { q.datepicker(b) } q.bind("pblur", function (v, u) { var t = MvcControlsToolkit_DisplayEdit_Blur(p, o, n, h, g, f, k, j, m, l, e, c, a, !d && !u); if (u) { u.goneDisplay = t } return false }); try { q.trigger("pblur") } catch (s) { } q.blur(function () { q.trigger("pblur"); return true }); if (d == "click") { $("#" + o).click(function () { MvcControlsToolkit_DisplayEdit_DbClick(p, o); return true }) } else { if (d == "dblclick") { $("#" + o).dblclick(function () { MvcControlsToolkit_DisplayEdit_DbClick(p, o); return true }) } } $("#" + o).bind("pedit", function () { MvcControlsToolkit_DisplayEdit_DbClick(p, o); return true }); q.keypress(function (t) { return MvcControlsToolkit_TypedTextBox_Input(t.which, p, o, n, m, l, k, j) }) }) } function MvcControlsToolkit_DisplayEdit_Blur(q, z, p, m, t, u, v, b, f, k, h, g, l, x) { var a = document.getElementById(q); if (a == null) { return } var n = a.value; if (l == "select") { n = $(a).find("option:selected").text() } var o = n; if (p != MvcControlsToolkit_DataType_String && p != MvcControlsToolkit_DataType_DateTime) { n = MvcControlsToolkit_Trim(n); o = n; var d = n; d = d.replace(k, ""); tvalue = d.replace(v, ""); negative = d.indexOf(b); d = d.replace(b, ""); var y = ""; var c = ""; for (var s = 0; s < d.length; s++) { c = d.charCodeAt(s); if ((c >= 48 && c <= 57) || c == f.charCodeAt(0)) { y = y + d.charAt(s) } } d = y; if (n != "") { var j = 0; try { j = MvcControlsToolkit_Parse(d, p); if (negative >= 0) { j = j * -1 } if (!isNaN(j)) { n = MvcControlsToolkit_ToString(j, u, p); if (p == MvcControlsToolkit_DataType_Float) { if (negative >= 0) { o = b + d } else { o = d } } else { o = MvcControlsToolkit_ToString(j, "n0", p) } } } catch (w) { } } } if (p == MvcControlsToolkit_DataType_DateTime) { o = MvcControlsToolkit_ToString(MvcControlsToolkit_Parse(o, p), u, p); n = o } if (l == "select") { } else { a.value = o } if (MvcControlsToolkit_Validate(q, h) && !x) { $("#" + q).hide(); $("#" + z).show(); if (n == "") { if (g == "") { $("#" + z).html("&nbsp;&nbsp;&nbsp;") } else { $("#" + z).text(g) } } else { $("#" + z).text(m + n + t) } $("#" + q).trigger("TypedEditDisplay_Changed"); return true } else { $("#" + q).trigger("TypedEditDisplay_Changed"); return false } } function MvcControlsToolkit_EditDisplayButton(m, f, c, h, l) { var j = $(m); var a = j.data("_editDisplayState_") || { display: false, jElements: j.parents(f).first().find("[data-element-type=TypedEditDisplay]") }; var g = j[0]; function e(o) { var n = true; o.each(function () { var p = { goneDisplay: false }; $(this).trigger("pblur", p); if (!p.goneDisplay) { n = false } }); return n } function d(p, o) { var n = p.tagName.toLowerCase(); if (n == "a") { $(p).text(o) } else { if (n == "img") { $(p).attr("src", o) } else { $(p).val(o) } } } function k(n) { n.each(function () { $("#" + $(this).attr("id") + "_display").trigger("pedit") }) } function b(o, n, p) { if (!p) { return } o.each(function () { p(this, n) }) } if (a.display) { k(a.jElements); d(g, c); a.display = false; b(a.jElements, "goneEdit", l) } else { res = e(a.jElements); if (res) { d(g, h); a.display = true; b(a.jElements, "goneDisplay", l) } else { k(a.jElements); b(a.jElements, "failedGoneEdit", l) } } $(g).data("_editDisplayState_", a) } function MvcControlsToolkit_TypedTextBox_BindChange(b, a) { $("#" + b + "_hidden").bind("TypedTextBox_Changed", a) } function MvcControlsToolkit_TypedTextBox_UnbindChange(b, a) { $("#" + b + "_hidden").unbind("TypedTextBox_Changed", a) } function MvcControlsToolkit_TypedEditDisplay_BindChange(b, a) { $("#" + b).bind("TypedEditDisplay_Changed", a) } function MvcControlsToolkit_TypedEditDisplay_UnbindChange(b, a) { $("#" + b).unbind("TypedEditDisplay_Changed", a) } function MvcControlsToolkit_TypedTextBox_SetString(b, a) { var b = $(b); b.trigger("focus"); b.val(a); b.trigger("blur") } function MvcControlsToolkit_TypedInput_Load(a, b) { var b = $(b); b.trigger("pfocus"); b.val(a); b.trigger("pblur") } function MvcControlsToolkit_TypedTextBox_GetString(a) { var b = a.id.substring(0, a.id.lastIndexOf("_")); return $("#" + b).val() } function MvcControlsToolkit_TypedTextBox_Set(c, b, f, h) { var e = $(c); if (!h) { h = parseInt(e.attr("data-client-type")) } var d = c.id.substring(0, c.id.lastIndexOf("_")); var g = $("#" + d); if (g.length == 0) { var a = function () { MvcControlsToolkit_TypedTextBox_Set(c, b, f, h) }; setTimeout(a, 0); return } var b = MvcControlsToolkit_Format(b, f, h, "", ""); g.val(b); e.val(b); e.trigger("pfocus"); e.trigger("pblur") } function MvcControlsToolkit_TypedTextBox_SetById(f, a, c, e) { var b = $("#" + f + "_hidden"); if (!e) { e = parseInt(b.attr("data-client-type")) } var d = $("#" + f); var a = MvcControlsToolkit_Format(a, c, e, "", ""); d.val(a); b.val(a); b.trigger("pfocus"); b.trigger("pblur") } function MvcControlsToolkit_TypedTextBox_Get(a, c) { var b = a.id.substring(0, a.id.lastIndexOf("_")); return MvcControlsToolkit_Parse($("#" + b).val(), c) } function MvcControlsToolkit_TypedTextBox_GetById(b, a) { return MvcControlsToolkit_Parse($("#" + b).val(), a) } function MvcControlsToolkit_TypedEditDisplay_SetString(b, a) { var b = $(b); b.val(a); b.trigger("blur") } function MvcControlsToolkit_TypedEditDisplay_GetString(a) { return $(a).val() } function MvcControlsToolkit_TypedEditDisplay_Set(b, a, d, e) { var c = $(b); if (!e) { e = parseInt(c.attr("data-client-type")) } $(b).val(MvcControlsToolkit_Format(a, d, e, "", "")); c.trigger("pblur") } function MvcControlsToolkit_TypedEditDisplay_SetById(e, a, c, d) { var b = $("#" + e); if (!d) { d = parseInt(b.attr("data-client-type")) } b.val(MvcControlsToolkit_Format(a, c, d, "", "")); b.trigger("pblur") } function MvcControlsToolkit_TypedEditDisplay_Get(a, b) { return MvcControlsToolkit_Parse($(a).val(), b) } function MvcControlsToolkit_TypedEditDisplay_GetById(b, a) { return MvcControlsToolkit_Parse($("#" + b).val(), a) } function MvcControlsToolkit_DisplayField_SetString(b, a) { return } function MvcControlsToolkit_DisplayField_GetString(field) { return eval(field.id + "_True") } function MvcControlsToolkit_AjaxLink(b, a) { $.ajax({ type: "GET", url: b, success: function (c) { $("#" + a).html(c) } }) } function MvcControlsToolkit_AjaxSubmit(a, b) { if (!MvcControlsToolkit_FormIsValid(b, a)) { return } $("#" + b).parents("form").submit() } function MvcControlsToolkit_UpdateDropDownOptions(c, f, b, a, d, e) { $.getJSON(c, function (k) { var g = []; var h = function (n, m) { var l = null; if (typeof (a) == "function") { l = a(n) } else { l = a } g.push("<option value ='" + n + "' " + (l == null ? "" : "class = '" + l + "' ") + ">" + m + "</option>") }; var j = function (m, l, o) { var p = null; if (typeof (d) == "function") { p = d(o) } else { p = d } g.push("<optgroup label ='" + m + "' " + (p == null ? "" : "class = '" + p + "' ") + ">"); for (var n = 0; n < l.length; n++) { h(l[n].Value, l[n].Text) } g.push("</optgroup>") }; if (b != null) { h("", b) } $.each(k, function (l, m) { if ("Group" in m) { if ("Value" in m) { j(m.Text, m.Group, m.Value) } else { j(m.Text, m.Group, m.Text) } } else { h(m.Value, m.Text) } }); f.html(g.join("")); if (e != null && typeof (e) == "function") { e(f) } }) } $(document).ready(function () { $(".MvcControlsToolkit-Hover").live("mouseover", function (a) { $(this).addClass("MvcControlsToolkit-Hover-On") }); $(".MvcControlsToolkit-Hover").live("mouseleave", function (a) { if (a.relatedTarget.tagName.toLowerCase() == "select") { return } $(this).removeClass("MvcControlsToolkit-Hover-On"); $(this).find("select").trigger("blur") }) }); var MvcControlsToolkit_ParseRegister = (function () { var a = []; var b = false; return { add: function (d, c) { a.push({ f: d, i: c }); if (c) { b = true } }, parse: function (c) { for (i = 0; i < a.length; i++) { a[i].f(c) } }, init: function () { if (b) { for (i = 0; i < a.length; i++) { if (a[i].i) { a[i].f() } } } } } })(); $(document).ready(function () { MvcControlsToolkit_ParseRegister.init() });